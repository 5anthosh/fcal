!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).fcal=e()}}(function(){var e={exports:{}};!function(t){"use strict";var n,r,i,s,o=9e15,u=1e9,c="0123456789abcdef",a="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",h="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",l={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-o,maxE:o,crypto:!1},p=!0,f="[DecimalError] ",d=f+"Invalid argument: ",m=f+"Precision limit exceeded",w=f+"crypto unavailable",T=Math.floor,N=Math.pow,g=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,E=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,v=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,b=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,y=1e7,x=7,A=a.length-1,P=h.length-1,k={name:"[object Decimal]"};function M(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)r=e[t]+"",(n=x-r.length)&&(s+=Y(n)),s+=r;o=e[t],(n=x-(r=o+"").length)&&(s+=Y(n))}else if(0===o)return"0";for(;o%10==0;)o/=10;return s+o}function O(e,t,n){if(e!==~~e||e<t||e>n)throw Error(d+e)}function S(e,t,n,r){var i,s,o,u;for(s=e[0];s>=10;s/=10)--t;return--t<0?(t+=x,i=0):(i=Math.ceil((t+1)/x),t%=x),s=N(10,x-t),u=e[i]%s|0,null==r?t<3?(0==t?u=u/100|0:1==t&&(u=u/10|0),o=n<4&&99999==u||n>3&&49999==u||5e4==u||0==u):o=(n<4&&u+1==s||n>3&&u+1==s/2)&&(e[i+1]/s/100|0)==N(10,t-2)-1||(u==s/2||0==u)&&0==(e[i+1]/s/100|0):t<4?(0==t?u=u/1e3|0:1==t?u=u/100|0:2==t&&(u=u/10|0),o=(r||n<4)&&9999==u||!r&&n>3&&4999==u):o=((r||n<4)&&u+1==s||!r&&n>3&&u+1==s/2)&&(e[i+1]/s/1e3|0)==N(10,t-3)-1,o}function C(e,t,n){for(var r,i,s=[0],o=0,u=e.length;o<u;){for(i=s.length;i--;)s[i]*=t;for(s[0]+=c.indexOf(e.charAt(o++)),r=0;r<s.length;r++)s[r]>n-1&&(void 0===s[r+1]&&(s[r+1]=0),s[r+1]+=s[r]/n|0,s[r]%=n)}return s.reverse()}k.absoluteValue=k.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),R(e)},k.ceil=function(){return R(new this.constructor(this),this.e+1,2)},k.comparedTo=k.cmp=function(e){var t,n,r,i,s=this,o=s.d,u=(e=new s.constructor(e)).d,c=s.s,a=e.s;if(!o||!u)return c&&a?c!==a?c:o===u?0:!o^c<0?1:-1:NaN;if(!o[0]||!u[0])return o[0]?c:u[0]?-a:0;if(c!==a)return c;if(s.e!==e.e)return s.e>e.e^c<0?1:-1;for(t=0,n=(r=o.length)<(i=u.length)?r:i;t<n;++t)if(o[t]!==u[t])return o[t]>u[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1},k.cosine=k.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+x,r.rounding=1,n=function(e,t){var n,r,i=t.d.length;i<32?r=(1/W(4,n=Math.ceil(i/3))).toString():(n=16,r="2.3283064365386962890625e-10"),e.precision+=n,t=j(e,1,t.times(r),new e(1));for(var s=n;s--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}(r,Q(r,n)),r.precision=e,r.rounding=t,R(2==s||3==s?n.neg():n,e,t,!0)):new r(1):new r(NaN)},k.cubeRoot=k.cbrt=function(){var e,t,n,r,i,s,o,u,c,a,h=this,l=h.constructor;if(!h.isFinite()||h.isZero())return new l(h);for(p=!1,(s=h.s*N(h.s*h,1/3))&&Math.abs(s)!=1/0?r=new l(s.toString()):(n=M(h.d),(s=((e=h.e)-n.length+1)%3)&&(n+=1==s||-2==s?"0":"00"),s=N(n,1/3),e=T((e+1)/3)-(e%3==(e<0?-1:2)),(r=new l(n=s==1/0?"5e"+e:(n=s.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=h.s),o=(e=l.precision)+3;;)if(a=(c=(u=r).times(u).times(u)).plus(h),r=L(a.plus(h).times(u),a.plus(c),o+2,1),M(u.d).slice(0,o)===(n=M(r.d)).slice(0,o)){if("9999"!=(n=n.slice(o-3,o+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(R(r,e+1,1),t=!r.times(r).times(r).eq(h));break}if(!i&&(R(u,e+1,0),u.times(u).times(u).eq(h))){r=u;break}o+=4,i=1}return p=!0,R(r,e,l.rounding,t)},k.decimalPlaces=k.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=((e=t.length-1)-T(this.e/x))*x,e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},k.dividedBy=k.div=function(e){return L(this,new this.constructor(e))},k.dividedToIntegerBy=k.divToInt=function(e){var t=this.constructor;return R(L(this,new t(e),0,1,1),t.precision,t.rounding)},k.equals=k.eq=function(e){return 0===this.cmp(e)},k.floor=function(){return R(new this.constructor(this),this.e+1,3)},k.greaterThan=k.gt=function(e){return this.cmp(e)>0},k.greaterThanOrEqualTo=k.gte=function(e){var t=this.cmp(e);return 1==t||0===t},k.hyperbolicCosine=k.cosh=function(){var e,t,n,r,i,s=this,o=s.constructor,u=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return u;n=o.precision,r=o.rounding,o.precision=n+Math.max(s.e,s.sd())+4,o.rounding=1,(i=s.d.length)<32?t=(1/W(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),s=j(o,1,s.times(t),new o(1),!0);for(var c,a=e,h=new o(8);a--;)c=s.times(s),s=u.minus(c.times(h.minus(c.times(h))));return R(s,o.precision=n,o.rounding=r,!0)},k.hyperbolicSine=k.sinh=function(){var e,t,n,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(t=s.precision,n=s.rounding,s.precision=t+Math.max(i.e,i.sd())+4,s.rounding=1,(r=i.d.length)<3)i=j(s,2,i,i,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,i=j(s,2,i=i.times(1/W(5,e)),i,!0);for(var o,u=new s(5),c=new s(16),a=new s(20);e--;)o=i.times(i),i=i.times(u.plus(o.times(c.times(o).plus(a))))}return s.precision=t,s.rounding=n,R(i,t,n,!0)},k.hyperbolicTangent=k.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,L(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},k.inverseCosine=k.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,s=n.rounding;return-1!==r?0===r?t.isNeg()?D(n,i,s):new n(0):new n(NaN):t.isZero()?D(n,i+4,s).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=D(n,i+4,s).times(.5),n.precision=i,n.rounding=s,e.minus(t))},k.inverseHyperbolicCosine=k.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,p=!1,n=n.times(n).minus(1).sqrt().plus(n),p=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},k.inverseHyperbolicSine=k.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,p=!1,n=n.times(n).plus(1).sqrt().plus(n),p=!0,r.precision=e,r.rounding=t,n.ln())},k.inverseHyperbolicTangent=k.atanh=function(){var e,t,n,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=s.precision,t=s.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?R(new s(i),e,t,!0):(s.precision=n=r-i.e,i=L(i.plus(1),new s(1).minus(i),n+e,1),s.precision=e+4,s.rounding=1,i=i.ln(),s.precision=e,s.rounding=t,i.times(.5))):new s(NaN)},k.inverseSine=k.asin=function(){var e,t,n,r,i=this,s=i.constructor;return i.isZero()?new s(i):(t=i.abs().cmp(1),n=s.precision,r=s.rounding,-1!==t?0===t?((e=D(s,n+4,r).times(.5)).s=i.s,e):new s(NaN):(s.precision=n+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=n,s.rounding=r,i.times(2)))},k.inverseTangent=k.atan=function(){var e,t,n,r,i,s,o,u,c,a=this,h=a.constructor,l=h.precision,f=h.rounding;if(a.isFinite()){if(a.isZero())return new h(a);if(a.abs().eq(1)&&l+4<=P)return(o=D(h,l+4,f).times(.25)).s=a.s,o}else{if(!a.s)return new h(NaN);if(l+4<=P)return(o=D(h,l+4,f).times(.5)).s=a.s,o}for(h.precision=u=l+10,h.rounding=1,e=n=Math.min(28,u/x+2|0);e;--e)a=a.div(a.times(a).plus(1).sqrt().plus(1));for(p=!1,t=Math.ceil(u/x),r=1,c=a.times(a),o=new h(a),i=a;-1!==e;)if(i=i.times(c),s=o.minus(i.div(r+=2)),i=i.times(c),void 0!==(o=s.plus(i.div(r+=2))).d[t])for(e=t;o.d[e]===s.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),p=!0,R(o,h.precision=l,h.rounding=f,!0)},k.isFinite=function(){return!!this.d},k.isInteger=k.isInt=function(){return!!this.d&&T(this.e/x)>this.d.length-2},k.isNaN=function(){return!this.s},k.isNegative=k.isNeg=function(){return this.s<0},k.isPositive=k.isPos=function(){return this.s>0},k.isZero=function(){return!!this.d&&0===this.d[0]},k.lessThan=k.lt=function(e){return this.cmp(e)<0},k.lessThanOrEqualTo=k.lte=function(e){return this.cmp(e)<1},k.logarithm=k.log=function(e){var t,n,r,i,s,o,u,c,a=this.constructor,h=a.precision,l=a.rounding;if(null==e)e=new a(10),t=!0;else{if(n=(e=new a(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new a(NaN);t=e.eq(10)}if(n=this.d,this.s<0||!n||!n[0]||this.eq(1))return new a(n&&!n[0]?-1/0:1!=this.s?NaN:n?0:1/0);if(t)if(n.length>1)s=!0;else{for(i=n[0];i%10==0;)i/=10;s=1!==i}if(p=!1,o=H(this,u=h+5),r=t?I(a,u+10):H(e,u),S((c=L(o,r,u,1)).d,i=h,l))do{if(o=H(this,u+=10),r=t?I(a,u+10):H(e,u),c=L(o,r,u,1),!s){+M(c.d).slice(i+1,i+15)+1==1e14&&(c=R(c,h+1,0));break}}while(S(c.d,i+=10,l));return p=!0,R(c,h,l)},k.minus=k.sub=function(e){var t,n,r,i,s,o,u,c,a,h,l,f,d=this,m=d.constructor;if(e=new m(e),!d.d||!e.d)return d.s&&e.s?d.d?e.s=-e.s:e=new m(e.d||d.s!==e.s?d:NaN):e=new m(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(a=d.d,f=e.d,u=m.precision,c=m.rounding,!a[0]||!f[0]){if(f[0])e.s=-e.s;else{if(!a[0])return new m(3===c?-0:0);e=new m(d)}return p?R(e,u,c):e}if(n=T(e.e/x),h=T(d.e/x),a=a.slice(),s=h-n){for((l=s<0)?(t=a,s=-s,o=f.length):(t=f,n=h,o=a.length),s>(r=Math.max(Math.ceil(u/x),o)+2)&&(s=r,t.length=1),t.reverse(),r=s;r--;)t.push(0);t.reverse()}else{for((l=(r=a.length)<(o=f.length))&&(o=r),r=0;r<o;r++)if(a[r]!=f[r]){l=a[r]<f[r];break}s=0}for(l&&(t=a,a=f,f=t,e.s=-e.s),o=a.length,r=f.length-o;r>0;--r)a[o++]=0;for(r=f.length;r>s;){if(a[--r]<f[r]){for(i=r;i&&0===a[--i];)a[i]=y-1;--a[i],a[r]+=y}a[r]-=f[r]}for(;0===a[--o];)a.pop();for(;0===a[0];a.shift())--n;return a[0]?(e.d=a,e.e=F(a,n),p?R(e,u,c):e):new m(3===c?-0:0)},k.modulo=k.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?R(new r(n),r.precision,r.rounding):(p=!1,9==r.modulo?(t=L(n,e.abs(),0,3,1)).s*=e.s:t=L(n,e,0,r.modulo,1),t=t.times(e),p=!0,n.minus(t))},k.naturalExponential=k.exp=function(){return V(this)},k.naturalLogarithm=k.ln=function(){return H(this)},k.negated=k.neg=function(){var e=new this.constructor(this);return e.s=-e.s,R(e)},k.plus=k.add=function(e){var t,n,r,i,s,o,u,c,a,h,l=this,f=l.constructor;if(e=new f(e),!l.d||!e.d)return l.s&&e.s?l.d||(e=new f(e.d||l.s===e.s?l:NaN)):e=new f(NaN),e;if(l.s!=e.s)return e.s=-e.s,l.minus(e);if(a=l.d,h=e.d,u=f.precision,c=f.rounding,!a[0]||!h[0])return h[0]||(e=new f(l)),p?R(e,u,c):e;if(s=T(l.e/x),r=T(e.e/x),a=a.slice(),i=s-r){for(i<0?(n=a,i=-i,o=h.length):(n=h,r=s,o=a.length),i>(o=(s=Math.ceil(u/x))>o?s+1:o+1)&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((o=a.length)-(i=h.length)<0&&(i=o,n=h,h=a,a=n),t=0;i;)t=(a[--i]=a[i]+h[i]+t)/y|0,a[i]%=y;for(t&&(a.unshift(t),++r),o=a.length;0==a[--o];)a.pop();return e.d=a,e.e=F(a,r),p?R(e,u,c):e},k.precision=k.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(d+e);return n.d?(t=_(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},k.round=function(){var e=this,t=e.constructor;return R(new t(e),e.e+1,t.rounding)},k.sine=k.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+x,r.rounding=1,n=function(e,t){var n,r=t.d.length;if(r<3)return j(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=j(e,2,t=t.times(1/W(5,n)),t);for(var i,s=new e(5),o=new e(16),u=new e(20);n--;)i=t.times(t),t=t.times(s.plus(i.times(o.times(i).minus(u))));return t}(r,Q(r,n)),r.precision=e,r.rounding=t,R(s>2?n.neg():n,e,t,!0)):new r(NaN)},k.squareRoot=k.sqrt=function(){var e,t,n,r,i,s,o=this,u=o.d,c=o.e,a=o.s,h=o.constructor;if(1!==a||!u||!u[0])return new h(!a||a<0&&(!u||u[0])?NaN:u?o:1/0);for(p=!1,0==(a=Math.sqrt(+o))||a==1/0?(((t=M(u)).length+c)%2==0&&(t+="0"),a=Math.sqrt(t),c=T((c+1)/2)-(c<0||c%2),r=new h(t=a==1/0?"1e"+c:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+c)):r=new h(a.toString()),n=(c=h.precision)+3;;)if(r=(s=r).plus(L(o,s,n+2,1)).times(.5),M(s.d).slice(0,n)===(t=M(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(R(r,c+1,1),e=!r.times(r).eq(o));break}if(!i&&(R(s,c+1,0),s.times(s).eq(o))){r=s;break}n+=4,i=1}return p=!0,R(r,c,h.rounding,e)},k.tangent=k.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=L(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,R(2==s||4==s?n.neg():n,e,t,!0)):new r(NaN)},k.times=k.mul=function(e){var t,n,r,i,s,o,u,c,a,h=this,l=h.constructor,f=h.d,d=(e=new l(e)).d;if(e.s*=h.s,!(f&&f[0]&&d&&d[0]))return new l(!e.s||f&&!f[0]&&!d||d&&!d[0]&&!f?NaN:f&&d?0*e.s:e.s/0);for(n=T(h.e/x)+T(e.e/x),(c=f.length)<(a=d.length)&&(s=f,f=d,d=s,o=c,c=a,a=o),s=[],r=o=c+a;r--;)s.push(0);for(r=a;--r>=0;){for(t=0,i=c+r;i>r;)u=s[i]+d[r]*f[i-r-1]+t,s[i--]=u%y|0,t=u/y|0;s[i]=(s[i]+t)%y|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=F(s,n),p?R(e,l.precision,l.rounding):e},k.toBinary=function(e,t){return J(this,2,e,t)},k.toDecimalPlaces=k.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(O(e,0,u),void 0===t?t=r.rounding:O(t,0,8),R(n,e+n.e+1,t))},k.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=U(r,!0):(O(e,0,u),void 0===t?t=i.rounding:O(t,0,8),n=U(r=R(new i(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},k.toFixed=function(e,t){var n,r,i=this,s=i.constructor;return void 0===e?n=U(i):(O(e,0,u),void 0===t?t=s.rounding:O(t,0,8),n=U(r=R(new s(i),e+i.e+1,t),!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},k.toFraction=function(e){var t,n,r,i,s,o,u,c,a,h,l,f,m=this,w=m.d,T=m.constructor;if(!w)return new T(m);if(a=n=new T(1),r=c=new T(0),o=(s=(t=new T(r)).e=_(w)-m.e-1)%x,t.d[0]=N(10,o<0?x+o:o),null==e)e=s>0?t:a;else{if(!(u=new T(e)).isInt()||u.lt(a))throw Error(d+u);e=u.gt(t)?s>0?t:a:u}for(p=!1,u=new T(M(w)),h=T.precision,T.precision=s=w.length*x*2;l=L(u,t,0,1,1),1!=(i=n.plus(l.times(r))).cmp(e);)n=r,r=i,i=a,a=c.plus(l.times(i)),c=i,i=t,t=u.minus(l.times(i)),u=i;return i=L(e.minus(n),r,0,1,1),c=c.plus(i.times(a)),n=n.plus(i.times(r)),c.s=a.s=m.s,f=L(a,r,s,1).minus(m).abs().cmp(L(c,n,s,1).minus(m).abs())<1?[a,r]:[c,n],T.precision=h,p=!0,f},k.toHexadecimal=k.toHex=function(e,t){return J(this,16,e,t)},k.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:O(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(p=!1,n=L(n,e,0,t,1).times(e),p=!0,R(n)):(e.s=n.s,n=e),n},k.toNumber=function(){return+this},k.toOctal=function(e,t){return J(this,8,e,t)},k.toPower=k.pow=function(e){var t,n,r,i,s,o,u=this,c=u.constructor,a=+(e=new c(e));if(!(u.d&&e.d&&u.d[0]&&e.d[0]))return new c(N(+u,a));if((u=new c(u)).eq(1))return u;if(r=c.precision,s=c.rounding,e.eq(1))return R(u,r,s);if((t=T(e.e/x))>=e.d.length-1&&(n=a<0?-a:a)<=9007199254740991)return i=$(c,u,n,r),e.s<0?new c(1).div(i):R(i,r,s);if((o=u.s)<0){if(t<e.d.length-1)return new c(NaN);if(0==(1&e.d[t])&&(o=1),0==u.e&&1==u.d[0]&&1==u.d.length)return u.s=o,u}return(t=0!=(n=N(+u,a))&&isFinite(n)?new c(n+"").e:T(a*(Math.log("0."+M(u.d))/Math.LN10+u.e+1)))>c.maxE+1||t<c.minE-1?new c(t>0?o/0:0):(p=!1,c.rounding=u.s=1,n=Math.min(12,(t+"").length),(i=V(e.times(H(u,r+n)),r)).d&&S((i=R(i,r+5,1)).d,r,s)&&(t=r+10,+M((i=R(V(e.times(H(u,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=R(i,r+1,0))),i.s=o,p=!0,c.rounding=s,R(i,r,s))},k.toPrecision=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=U(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(O(e,1,u),void 0===t?t=i.rounding:O(t,0,8),n=U(r=R(new i(r),e,t),e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},k.toSignificantDigits=k.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(O(e,1,u),void 0===t?t=n.rounding:O(t,0,8)),R(new n(this),e,t)},k.toString=function(){var e=this,t=e.constructor,n=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},k.truncated=k.trunc=function(){return R(new this.constructor(this),this.e+1,1)},k.valueOf=k.toJSON=function(){var e=this,t=e.constructor,n=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var L=function(){function e(e,t,n){var r,i=0,s=e.length;for(e=e.slice();s--;)r=e[s]*t+i,e[s]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function t(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(i,s,o,u,c,a){var h,l,p,f,d,m,w,N,g,E,v,b,A,P,k,M,O,S,C,L,U=i.constructor,F=i.s==s.s?1:-1,I=i.d,D=s.d;if(!(I&&I[0]&&D&&D[0]))return new U(i.s&&s.s&&(I?!D||I[0]!=D[0]:D)?I&&0==I[0]||!D?0*F:F/0:NaN);for(a?(d=1,l=i.e-s.e):(a=y,d=x,l=T(i.e/d)-T(s.e/d)),C=D.length,O=I.length,E=(g=new U(F)).d=[],p=0;D[p]==(I[p]||0);p++);if(D[p]>(I[p]||0)&&l--,null==o?(P=o=U.precision,u=U.rounding):P=c?o+(i.e-s.e)+1:o,P<0)E.push(1),m=!0;else{if(P=P/d+2|0,p=0,1==C){for(f=0,D=D[0],P++;(p<O||f)&&P--;p++)k=f*a+(I[p]||0),E[p]=k/D|0,f=k%D|0;m=f||p<O}else{for((f=a/(D[0]+1)|0)>1&&(D=e(D,f,a),I=e(I,f,a),C=D.length,O=I.length),M=C,b=(v=I.slice(0,C)).length;b<C;)v[b++]=0;(L=D.slice()).unshift(0),S=D[0],D[1]>=a/2&&++S;do{f=0,(h=t(D,v,C,b))<0?(A=v[0],C!=b&&(A=A*a+(v[1]||0)),(f=A/S|0)>1?(f>=a&&(f=a-1),1==(h=t(w=e(D,f,a),v,N=w.length,b=v.length))&&(f--,n(w,C<N?L:D,N,a))):(0==f&&(h=f=1),w=D.slice()),(N=w.length)<b&&w.unshift(0),n(v,w,b,a),-1==h&&(h=t(D,v,C,b=v.length))<1&&(f++,n(v,C<b?L:D,b,a)),b=v.length):0===h&&(f++,v=[0]),E[p++]=f,h&&v[0]?v[b++]=I[M]||0:(v=[I[M]],b=1)}while((M++<O||void 0!==v[0])&&P--);m=void 0!==v[0]}E[0]||E.shift()}if(1==d)g.e=l,r=m;else{for(p=1,f=E[0];f>=10;f/=10)p++;g.e=p+l*d-1,R(g,c?o+g.e+1:o,u,m)}return g}}();function R(e,t,n,r){var i,s,o,u,c,a,h,l,f,d=e.constructor;e:if(null!=t){if(!(l=e.d))return e;for(i=1,u=l[0];u>=10;u/=10)i++;if((s=t-i)<0)s+=x,o=t,c=(h=l[f=0])/N(10,i-o-1)%10|0;else if((f=Math.ceil((s+1)/x))>=(u=l.length)){if(!r)break e;for(;u++<=f;)l.push(0);h=c=0,i=1,o=(s%=x)-x+1}else{for(h=u=l[f],i=1;u>=10;u/=10)i++;c=(o=(s%=x)-x+i)<0?0:h/N(10,i-o-1)%10|0}if(r=r||t<0||void 0!==l[f+1]||(o<0?h:h%N(10,i-o-1)),a=n<4?(c||r)&&(0==n||n==(e.s<0?3:2)):c>5||5==c&&(4==n||r||6==n&&(s>0?o>0?h/N(10,i-o):0:l[f-1])%10&1||n==(e.s<0?8:7)),t<1||!l[0])return l.length=0,a?(t-=e.e+1,l[0]=N(10,(x-t%x)%x),e.e=-t||0):l[0]=e.e=0,e;if(0==s?(l.length=f,u=1,f--):(l.length=f+1,u=N(10,x-s),l[f]=o>0?(h/N(10,i-o)%N(10,o)|0)*u:0),a)for(;;){if(0==f){for(s=1,o=l[0];o>=10;o/=10)s++;for(o=l[0]+=u,u=1;o>=10;o/=10)u++;s!=u&&(e.e++,l[0]==y&&(l[0]=1));break}if(l[f]+=u,l[f]!=y)break;l[f--]=0,u=1}for(s=l.length;0===l[--s];)l.pop()}return p&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function U(e,t,n){if(!e.isFinite())return q(e);var r,i=e.e,s=M(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+Y(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(e.e<0?"e":"e+")+e.e):i<0?(s="0."+Y(-i-1)+s,n&&(r=n-o)>0&&(s+=Y(r))):i>=o?(s+=Y(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+Y(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=Y(r))),s}function F(e,t){var n=e[0];for(t*=x;n>=10;n/=10)t++;return t}function I(e,t,n){if(t>A)throw p=!0,n&&(e.precision=n),Error(m);return R(new e(a),t,1,!0)}function D(e,t,n){if(t>P)throw Error(m);return R(new e(h),t,n,!0)}function _(e){var t=e.length-1,n=t*x+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function Y(e){for(var t="";e--;)t+="0";return t}function $(e,t,n,r){var i,s=new e(1),o=Math.ceil(r/x+4);for(p=!1;;){if(n%2&&z((s=s.times(t)).d,o)&&(i=!0),0===(n=T(n/2))){n=s.d.length-1,i&&0===s.d[n]&&++s.d[n];break}z((t=t.times(t)).d,o)}return p=!0,s}function B(e){return 1&e.d[e.d.length-1]}function G(e,t,n){for(var r,i=new e(t[0]),s=0;++s<t.length;){if(!(r=new e(t[s])).s){i=r;break}i[n](r)&&(i=r)}return i}function V(e,t){var n,r,i,s,o,u,c,a=0,h=0,l=0,f=e.constructor,d=f.rounding,m=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(p=!1,c=m):c=t,u=new f(.03125);e.e>-2;)e=e.times(u),l+=5;for(c+=r=Math.log(N(2,l))/Math.LN10*2+5|0,n=s=o=new f(1),f.precision=c;;){if(s=R(s.times(e),c,1),n=n.times(++h),M((u=o.plus(L(s,n,c,1))).d).slice(0,c)===M(o.d).slice(0,c)){for(i=l;i--;)o=R(o.times(o),c,1);if(null!=t)return f.precision=m,o;if(!(a<3&&S(o.d,c-r,d,a)))return R(o,f.precision=m,d,p=!0);f.precision=c+=10,n=s=u=new f(1),h=0,a++}o=u}}function H(e,t){var n,r,i,s,o,u,c,a,h,l,f,d=1,m=e,w=m.d,T=m.constructor,N=T.rounding,g=T.precision;if(m.s<0||!w||!w[0]||!m.e&&1==w[0]&&1==w.length)return new T(w&&!w[0]?-1/0:1!=m.s?NaN:w?0:m);if(null==t?(p=!1,h=g):h=t,T.precision=h+=10,r=(n=M(w)).charAt(0),!(Math.abs(s=m.e)<15e14))return a=I(T,h+2,g).times(s+""),m=H(new T(r+"."+n.slice(1)),h-10).plus(a),T.precision=g,null==t?R(m,g,N,p=!0):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=M((m=m.times(e)).d)).charAt(0),d++;for(s=m.e,r>1?(m=new T("0."+n),s++):m=new T(r+"."+n.slice(1)),l=m,c=o=m=L(m.minus(1),m.plus(1),h,1),f=R(m.times(m),h,1),i=3;;){if(o=R(o.times(f),h,1),M((a=c.plus(L(o,new T(i),h,1))).d).slice(0,h)===M(c.d).slice(0,h)){if(c=c.times(2),0!==s&&(c=c.plus(I(T,h+2,g).times(s+""))),c=L(c,new T(d),h,1),null!=t)return T.precision=g,c;if(!S(c.d,h-10,N,u))return R(c,T.precision=g,N,p=!0);T.precision=h+=10,a=o=m=L(l.minus(1),l.plus(1),h,1),f=R(m.times(m),h,1),i=u=1}c=a,i+=2}}function q(e){return String(e.s*e.s/0)}function K(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%x,n<0&&(r+=x),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=x;r<i;)e.d.push(+t.slice(r,r+=x));t=t.slice(r),r=x-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),p&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Z(e,t){var r,i,s,o,u,c,a,h,l;if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(E.test(t))r=16,t=t.toLowerCase();else if(g.test(t))r=2;else{if(!v.test(t))throw Error(d+t);r=8}for((o=t.search(/p/i))>0?(a=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),u=(o=t.indexOf("."))>=0,i=e.constructor,u&&(o=(c=(t=t.replace(".","")).length)-o,s=$(i,new i(r),o,2*o)),o=l=(h=C(t,r,y)).length-1;0===h[o];--o)h.pop();return o<0?new i(0*e.s):(e.e=F(h,l),e.d=h,p=!1,u&&(e=L(e,s,4*c)),a&&(e=e.times(Math.abs(a)<54?N(2,a):n.pow(2,a))),p=!0,e)}function j(e,t,n,r,i){var s,o,u,c,a=e.precision,h=Math.ceil(a/x);for(p=!1,c=n.times(n),u=new e(r);;){if(o=L(u.times(c),new e(t++*t++),a,1),u=i?r.plus(o):r.minus(o),r=L(o.times(c),new e(t++*t++),a,1),void 0!==(o=u.plus(r)).d[h]){for(s=h;o.d[s]===u.d[s]&&s--;);if(-1==s)break}s=u,u=r,r=o,o=s}return p=!0,o.d.length=h+1,o}function W(e,t){for(var n=e;--t;)n*=e;return n}function Q(e,t){var n,r=t.s<0,i=D(e,e.precision,1),o=i.times(.5);if((t=t.abs()).lte(o))return s=r?4:1,t;if((n=t.divToInt(i)).isZero())s=r?3:2;else{if((t=t.minus(n.times(i))).lte(o))return s=B(n)?r?2:3:r?4:1,t;s=B(n)?r?1:4:r?3:2}return t.minus(i).abs()}function J(e,t,n,i){var s,o,a,h,l,p,f,d,m,w=e.constructor,T=void 0!==n;if(T?(O(n,1,u),void 0===i?i=w.rounding:O(i,0,8)):(n=w.precision,i=w.rounding),e.isFinite()){for(T?(s=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):s=t,(a=(f=U(e)).indexOf("."))>=0&&(f=f.replace(".",""),(m=new w(1)).e=f.length-a,m.d=C(U(m),10,s),m.e=m.d.length),o=l=(d=C(f,10,s)).length;0==d[--l];)d.pop();if(d[0]){if(a<0?o--:((e=new w(e)).d=d,e.e=o,d=(e=L(e,m,n,i,0,s)).d,o=e.e,p=r),a=d[n],h=s/2,p=p||void 0!==d[n+1],p=i<4?(void 0!==a||p)&&(0===i||i===(e.s<0?3:2)):a>h||a===h&&(4===i||p||6===i&&1&d[n-1]||i===(e.s<0?8:7)),d.length=n,p)for(;++d[--n]>s-1;)d[n]=0,n||(++o,d.unshift(1));for(l=d.length;!d[l-1];--l);for(a=0,f="";a<l;a++)f+=c.charAt(d[a]);if(T){if(l>1)if(16==t||8==t){for(a=16==t?4:3,--l;l%a;l++)f+="0";for(l=(d=C(f,s,t)).length;!d[l-1];--l);for(a=1,f="1.";a<l;a++)f+=c.charAt(d[a])}else f=f.charAt(0)+"."+f.slice(1);f=f+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)f="0"+f;f="0."+f}else if(++o>l)for(o-=l;o--;)f+="0";else o<l&&(f=f.slice(0,o)+"."+f.slice(o))}else f=T?"0p+0":"0";f=(16==t?"0x":2==t?"0b":8==t?"0o":"")+f}else f=q(e);return e.s<0?"-"+f:f}function z(e,t){if(e.length>t)return e.length=t,!0}function X(e){return new this(e).abs()}function ee(e){return new this(e).acos()}function te(e){return new this(e).acosh()}function ne(e,t){return new this(e).plus(t)}function re(e){return new this(e).asin()}function ie(e){return new this(e).asinh()}function se(e){return new this(e).atan()}function oe(e){return new this(e).atanh()}function ue(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,s=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?D(this,r,i):new this(0)).s=e.s:!e.d||t.isZero()?(n=D(this,s,1).times(.5)).s=e.s:t.s<0?(this.precision=s,this.rounding=1,n=this.atan(L(e,t,s,1)),t=D(this,s,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(L(e,t,s,1)):(n=D(this,s,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function ce(e){return new this(e).cbrt()}function ae(e){return R(e=new this(e),e.e+1,2)}function he(e){if(!e||"object"!=typeof e)throw Error(f+"Object expected");var t,n,r,i=!0===e.defaults,s=["precision",1,u,"rounding",0,8,"toExpNeg",-o,0,"toExpPos",0,o,"maxE",0,o,"minE",-o,0,"modulo",0,9];for(t=0;t<s.length;t+=3)if(n=s[t],i&&(this[n]=l[n]),void 0!==(r=e[n])){if(!(T(r)===r&&r>=s[t+1]&&r<=s[t+2]))throw Error(d+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=l[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(d+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(w);this[n]=!0}else this[n]=!1}return this}function le(e){return new this(e).cos()}function pe(e){return new this(e).cosh()}function fe(e,t){return new this(e).div(t)}function de(e){return new this(e).exp()}function me(e){return R(e=new this(e),e.e+1,3)}function we(){var e,t,n=new this(0);for(p=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return p=!0,new this(1/0);n=t}return p=!0,n.sqrt()}function Te(e){return e instanceof n||e&&"[object Decimal]"===e.name||!1}function Ne(e){return new this(e).ln()}function ge(e,t){return new this(e).log(t)}function Ee(e){return new this(e).log(2)}function ve(e){return new this(e).log(10)}function be(){return G(this,arguments,"lt")}function ye(){return G(this,arguments,"gt")}function xe(e,t){return new this(e).mod(t)}function Ae(e,t){return new this(e).mul(t)}function Pe(e,t){return new this(e).pow(t)}function ke(e){var t,n,r,i,s=0,o=new this(1),c=[];if(void 0===e?e=this.precision:O(e,1,u),r=Math.ceil(e/x),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));s<r;)(i=t[s])>=429e7?t[s]=crypto.getRandomValues(new Uint32Array(1))[0]:c[s++]=i%1e7;else{if(!crypto.randomBytes)throw Error(w);for(t=crypto.randomBytes(r*=4);s<r;)(i=t[s]+(t[s+1]<<8)+(t[s+2]<<16)+((127&t[s+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,s):(c.push(i%1e7),s+=4);s=r/4}else for(;s<r;)c[s++]=1e7*Math.random()|0;for(r=c[--s],e%=x,r&&e&&(i=N(10,x-e),c[s]=(r/i|0)*i);0===c[s];s--)c.pop();if(s<0)n=0,c=[0];else{for(n=-1;0===c[0];n-=x)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<x&&(n-=x-r)}return o.e=n,o.d=c,o}function Me(e){return R(e=new this(e),e.e+1,this.rounding)}function Oe(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function Se(e){return new this(e).sin()}function Ce(e){return new this(e).sinh()}function Le(e){return new this(e).sqrt()}function Re(e,t){return new this(e).sub(t)}function Ue(e){return new this(e).tan()}function Fe(e){return new this(e).tanh()}function Ie(e){return R(e=new this(e),e.e+1,1)}(n=function e(t){var n,r,i;function s(e){var t,n,r,i=this;if(!(i instanceof s))return new s(e);if(i.constructor=s,e instanceof s)return i.s=e.s,void(p?!e.d||e.e>s.maxE?(i.e=NaN,i.d=null):e.e<s.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"==(r=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(p?t>s.maxE?(i.e=NaN,i.d=null):t<s.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):K(i,e.toString())}if("string"!==r)throw Error(d+e);return 45===(n=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===n&&(e=e.slice(1)),i.s=1),b.test(e)?K(i,e):Z(i,e)}if(s.prototype=k,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=he,s.clone=e,s.isDecimal=Te,s.abs=X,s.acos=ee,s.acosh=te,s.add=ne,s.asin=re,s.asinh=ie,s.atan=se,s.atanh=oe,s.atan2=ue,s.cbrt=ce,s.ceil=ae,s.cos=le,s.cosh=pe,s.div=fe,s.exp=de,s.floor=me,s.hypot=we,s.ln=Ne,s.log=ge,s.log10=ve,s.log2=Ee,s.max=be,s.min=ye,s.mod=xe,s.mul=Ae,s.pow=Pe,s.random=ke,s.round=Me,s.sign=Oe,s.sin=Se,s.sinh=Ce,s.sqrt=Le,s.sub=Re,s.tan=Ue,s.tanh=Fe,s.trunc=Ie,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return s.config(t),s}(l)).default=n.Decimal=n,a=new n(a),h=new n(h),e.exports?("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(k[Symbol.for("nodejs.util.inspect.custom")]=k.toString,k[Symbol.toStringTag]="Decimal"),e.exports=n):(t||(t="undefined"!=typeof self&&self&&self.self==self?self:window),i=t.Decimal,n.noConflict=function(){return t.Decimal=i,n},t.Decimal=n)}(this),e=e.exports;var t,n,r={};Object.defineProperty(r,"__esModule",{value:!0});class i{}r.Type=i,function(e){e[e.NUMBER=0]="NUMBER",e[e.UNIT=1]="UNIT",e[e.PERCENTAGE=2]="PERCENTAGE"}(t=r.DATATYPE||(r.DATATYPE={})),function(e){e[e.PERCENTAGE=0]="PERCENTAGE",e[e.NUMBER=1]="NUMBER",e[e.UNIT=2]="UNIT"}(n=r.TYPERANK||(r.TYPERANK={})),function(r){class i extends r{constructor(t){super(),t instanceof e.Decimal?this.number=t:this.number=new e.Decimal(t),this.leftflag=!1}print(){return this.number.toString()}Add(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?e.newNumeric(this.plus(e).number):this.plus(e):e.TYPERANK>=this.TYPERANK?e.plus(this):this.newNumeric(e.plus(this).number)}Sub(e){return this.Add(e.negated())}times(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?e.newNumeric(this.mul(e).number):this.mul(e):e.TYPERANK>=this.TYPERANK?e.mul(this):this.newNumeric(e.mul(this).number)}divide(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?this.TYPERANK===e.TYPERANK?this.newNumeric(this.div(e).number):e.newNumeric(this.div(e).number):this.div(e):e.TYPERANK>=this.TYPERANK?e.div(this):this.newNumeric(e.div(this).number)}power(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?this.TYPERANK===e.TYPERANK?this.newNumeric(this.pow(e).number):e.newNumeric(this.pow(e).number):this.pow(e):e.TYPERANK>=this.TYPERANK?e.pow(this):this.newNumeric(e.pow(this).number)}modulo(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?this.TYPERANK===e.TYPERANK?this.newNumeric(this.mod(e).number):e.newNumeric(this.mod(e).number):this.mod(e):e.TYPERANK>=this.TYPERANK?e.mod(this):this.newNumeric(e.mod(this).number)}}r.Numberic=i;class s extends i{constructor(e){super(e),this.TYPE=t.NUMBER,this.TYPERANK=n.NUMBER}static New(e){return new s(e)}isZero(){return this.number.isZero()}isNegative(){return this.number.isNegative()}isInteger(){return this.number.isInteger()}negated(){return s.New(this.number.negated())}div(e){return s.New(this.number.div(e.number))}pow(e){return s.New(this.number.pow(e.number))}mod(e){return s.New(this.number.modulo(e.number))}mul(e){return s.New(this.number.mul(e.number))}plus(e){return s.New(this.number.plus(e.number))}newNumeric(e){return s.New(e)}}s.ZERO=s.New(new e.Decimal(0)),r.BNumber=s;class o extends i{constructor(e){super(e),this.TYPE=t.PERCENTAGE,this.TYPERANK=n.PERCENTAGE}static New(e){return new o(e)}isZero(){return this.number.isZero()}isNegative(){return this.number.isNegative()}isInteger(){return this.number.isInteger()}negated(){return o.New(this.number.negated())}plus(e){return e.TYPE===t.PERCENTAGE?o.New(this.number.plus(e.number)):o.New(e.number.plus(this.percentageValue(e.number)))}mul(e){return e.TYPE===t.PERCENTAGE?o.New(this.number.mul(e.number)):o.New(e.number.mul(this.percentageValue(e.number)))}div(e){return e.TYPE===t.PERCENTAGE?o.New(this.number.div(e.number)):e.leftflag?o.New(e.number.div(this.percentageValue(e.number))):o.New(this.percentageValue(e.number).div(e.number))}pow(e){return e.TYPE===t.PERCENTAGE?o.New(this.number.pow(e.number)):e.leftflag?o.New(e.number.pow(this.percentageValue(e.number))):o.New(this.percentageValue(e.number).pow(e.number))}mod(e){return e.TYPE===t.PERCENTAGE?o.New(this.number.mod(e.number)):e.leftflag?o.New(e.number.mod(this.percentageValue(e.number))):o.New(this.percentageValue(e.number).mod(e.number))}percentageValue(e){return e.mul(this.number.div(o.base))}print(){return`% ${this.number.toString()}`}newNumeric(e){return o.New(e)}}o.base=new e.Decimal(100),r.Percentage=o;class u extends i{constructor(e,r){super(e),this.unit=r,this.TYPE=t.UNIT,this.TYPERANK=n.UNIT}static New(e,t){return new u(e,t)}static convertToUnit(e,t){if(e instanceof u){const n=e;if(n.unit.id===t.id)return u.New(n.convert(t.ratio),t)}return u.New(e.number,t)}newNumeric(e){return new u(e,this.unit)}isZero(){return this.number.isZero()}isNegative(){return this.number.isNegative()}isInteger(){return this.number.isInteger()}negated(){return this.newNumeric(this.number.negated())}plus(e){if(e instanceof u){const t=e;return this.unit.id===t.unit.id&&this.unit.unitType===t.unit.unitType?this.newNumeric(this.number.add(t.number)):this.unit.id!==t.unit.id?t.newNumeric(this.number.add(t.number)):t.newNumeric(this.convert(t.unit.ratio).add(t.number))}return this.newNumeric(this.number.plus(e.number))}mul(e){if(e instanceof u){const t=e;return this.unit.id===t.unit.id&&this.unit.unitType===t.unit.unitType?this.newNumeric(this.number.mul(t.number)):this.unit.id!==t.unit.id?t.newNumeric(this.number.mul(t.number)):t.newNumeric(this.convert(t.unit.ratio).mul(t.number))}return this.newNumeric(this.number.mul(e.number))}div(e){let t,n;if(this.leftflag?(t=this,n=e):(n=this,t=e),e instanceof u){const e=t,r=n;return e.unit.unitType===r.unit.unitType?e.newNumeric(e.number.div(r.number)):e.unit.id!==r.unit.id?e.newNumeric(e.number.div(n.number)):e.newNumeric(e.number.div(r.convert(e.unit.ratio)))}return this.newNumeric(t.number.div(n.number))}pow(e){let t,n;if(this.leftflag?(t=this,n=e):(n=this,t=e),e instanceof u){const e=t,r=n;return e.unit.unitType===r.unit.unitType?e.newNumeric(e.number.pow(r.number)):e.unit.id!==r.unit.id?e.newNumeric(e.number.pow(n.number)):e.newNumeric(e.number.pow(r.convert(e.unit.ratio)))}return this.newNumeric(t.number.pow(n.number))}mod(e){let t,n;if(this.leftflag?(t=this,n=e):(n=this,t=e),e instanceof u){const e=t,r=n;return e.unit.id!==r.unit.id?e.newNumeric(e.number.mod(r.number)):e.unit.unitType===r.unit.unitType?e.newNumeric(e.number.mod(r.number)):e.newNumeric(e.number.mod(r.convert(e.unit.ratio)))}return this.newNumeric(t.number.mod(n.number))}convert(e){return this.number.div(e).mul(this.unit.ratio)}print(){return`${this.number.toString()} ${this.unit.unitType}`}}r.Units=u}(i=r.Type||(r.Type={}));var s={};Object.defineProperty(s,"__esModule",{value:!0}),s.FcalFunction=class{constructor(e,t){this.arbity=t,this.name=e}call(e,...t){const n=this.function(e,...t);return null===n?r.Type.BNumber.New("0"):n}},s.FcalFunctions=class{constructor(){this.functions=Array()}add(e){if(this.check(e.name))throw new Error(`${e.name} is already registered`);this.functions.push(e)}get(e){for(const t of this.functions)if(t.name===e)return[t,!0];return[null,!1]}check(e){for(const t of this.functions)if(t.name===e)return!0;return!1}};var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.getDefaultFunction=function(){const e=new s.FcalFunctions,t=new s.FcalFunction("abs",1);t.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.abs())},e.add(t);const n=new s.FcalFunction("sqrt",1);n.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.sqrt())},e.add(n);const r=new s.FcalFunction("cbrt",1);r.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.cbrt())},e.add(r);const i=new s.FcalFunction("log",1);i.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.log())},e.add(i);const o=new s.FcalFunction("ln",1);o.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.ln())},e.add(o);const u=new s.FcalFunction("round",1);u.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.round())},e.add(u);const c=new s.FcalFunction("floor",1);c.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.floor())},e.add(c);const a=new s.FcalFunction("ceil",1);a.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.ceil())},e.add(a);const h=new s.FcalFunction("cos",1);h.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.cosine())},e.add(h);const l=new s.FcalFunction("acos",1);l.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.inverseCosine())},e.add(l);const p=new s.FcalFunction("cosh",1);p.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.hyperbolicCosine())},e.add(p);const f=new s.FcalFunction("acosh",1);f.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.inverseHyperbolicCosine())},e.add(f);const d=new s.FcalFunction("sin",1);d.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.sine())},e.add(d);const m=new s.FcalFunction("asin",1);m.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.inverseSine())},e.add(m);const w=new s.FcalFunction("sinh",1);w.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.hyperbolicSine())},e.add(w);const T=new s.FcalFunction("asinh",1);T.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.inverseHyperbolicSine())},e.add(T);const N=new s.FcalFunction("tan",1);N.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.tangent())},e.add(N);const g=new s.FcalFunction("atan",1);g.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.inverseTangent())},e.add(g);const E=new s.FcalFunction("tanh",1);E.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.hyperbolicTangent())},e.add(E);const v=new s.FcalFunction("atanh",1);return v.function=function(e,...t){const n=t[0];return n.newNumeric(n.number.inverseHyperbolicTangent())},e.add(v),e};var u={};Object.defineProperty(u,"__esModule",{value:!0});class c{constructor(e,t,n){this.id=e,this.ratio=t,this.unitType=n}}class a{constructor(e,t,n,...r){this.unit=new c(e,t,n),this.phrases=r}}u.TType=a,function(e){e.TTypes=class{constructor(){this.ttypes=[]}Add(e){if(this.check(...e.phrases))throw new Error("phrase already exits");this.ttypes.push(e)}check(...e){for(const t of this.ttypes)for(const n of t.phrases)for(const t of e)if(n===t)return!0;return!1}get(e){for(const t of this.ttypes)for(const n of t.phrases)if(e===n)return[t.unit,!0];return[null,!1]}}}(a=u.TType||(u.TType={}));var h={};Object.defineProperty(h,"__esModule",{value:!0}),h.getdefaultTTypes=function(){const t=new u.TType.TTypes;return function(t){t.Add(new u.TType("LENGTH",new e.Decimal(1),"cm","cm")),t.Add(new u.TType("LENGTH",new e.Decimal(100),"m","m")),t.Add(new u.TType("LENGTH",new e.Decimal(.1),"mm","mm")),t.Add(new u.TType("LENGTH",new e.Decimal(1e5),"km","km")),t.Add(new u.TType("LENGTH",new e.Decimal(2.54),"inch","inch")),t.Add(new u.TType("LENGTH",new e.Decimal(30.48),"foot/feet","ft")),t.Add(new u.TType("LENGTH",new e.Decimal(91.44),"yard","yd","yard")),t.Add(new u.TType("LENGTH",new e.Decimal(160934.4),"mile","mi")),t.Add(new u.TType("LENGTH",new e.Decimal(185200),"nautical mile (nmi)","nmi"))}(t),function(t){t.Add(new u.TType("SPEED",new e.Decimal(1),"km/h","kmh","kmph","khm","kph")),t.Add(new u.TType("SPEED",new e.Decimal(1.609344),"miles/h","mph")),t.Add(new u.TType("SPEED",new e.Decimal(3.6),"m/s","mps")),t.Add(new u.TType("SPEED",new e.Decimal(1.097),"ft/s","fps")),t.Add(new u.TType("SPEED",new e.Decimal(1.852),"kt","kts","knots"))}(t),function(t){t.Add(new u.TType("TIME",new e.Decimal(1),"second(s)","sec","second")),t.Add(new u.TType("TIME",new e.Decimal(60),"minute(s)","min","minute")),t.Add(new u.TType("TIME",new e.Decimal(3600),"hour(s)","hr","hour")),t.Add(new u.TType("TIME",new e.Decimal(86400),"day(s)","day","day"))}(t),t};var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.Environment=class{constructor(){this.values={}}get(e){if(this.values.hasOwnProperty(e))return this.values[e];throw new Error(`Undefined variable ${e}`)}set(e,t){t instanceof r.Type?this.values[e]=t:this.values[e]=r.Type.BNumber.New(t)}};var p,f={};function d(e){return p[e]}Object.defineProperty(f,"__esModule",{value:!0}),function(e){e[e.PLUS=0]="PLUS",e[e.MINUS=1]="MINUS",e[e.TIMES=2]="TIMES",e[e.MOD=3]="MOD",e[e.SLASH=4]="SLASH",e[e.Number=5]="Number",e[e.OPEN_PARAN=6]="OPEN_PARAN",e[e.CLOSE_PARAN=7]="CLOSE_PARAN",e[e.NEWLINE=8]="NEWLINE",e[e.EOL=9]="EOL",e[e.IN=10]="IN",e[e.NAME=11]="NAME",e[e.EQUAL=12]="EQUAL",e[e.COMMA=13]="COMMA",e[e.PERCENTAGE=14]="PERCENTAGE",e[e.OF=15]="OF",e[e.UNIT=16]="UNIT",e[e.CAP=17]="CAP"}(p=f.TokenType||(f.TokenType={}));class m{constructor(e,t,n,r,i){this.type=e,this.lexeme=t,this.start=r,this.end=i,this.Literal=n}static EOLToken(e){return new m(p.EOL,"",null,e,e)}toString(){let e="";return null!==this.Literal&&(e=this.Literal.format()),`< ${d(this.type)} ${this.lexeme} ${e} (${this.start}, ${this.end})>`}}f.Token=m;var w={};Object.defineProperty(w,"__esModule",{value:!0});class T{}w.Char=T,T.PLUS="+",T.MINUS="-",T.TIMES="*",T.MOD="mod",T.SLASH="/",T.OPEN_PARAN="(",T.CLOSE_PARAN=")",T.CAP="^",T.PERCENTAGE="%",T.EQUAL="=",T.DOUBLE_COLON=":",T.COMMA=",",T.NEWLINE="\n";var N={};Object.defineProperty(N,"__esModule",{value:!0});class g{constructor(e,t,n){this.source=e.replace(/[ \t]+$/,""),this.start=0,this.current=0,this.tokens=[],this.phrases=t,this.ttypes=n}static isDigit(e){return e>="0"&&e<="9"}static isAlpha(e){return!g.isDigit(e)&&!this.isSpace(e)&&"\0"!==e&&"\n"!==e&&!g.notAlpha.includes(e)}static isSpace(e){return"\t"===e||" "===e}Next(){return this.isAtEnd()?f.Token.EOLToken(this.current):this.scan()}scan(){const e=this.space();switch(e){case w.Char.PLUS:return this.createToken(f.TokenType.PLUS);case w.Char.MINUS:return this.createToken(f.TokenType.MINUS);case w.Char.TIMES:return this.createToken(f.TokenType.TIMES);case w.Char.SLASH:return this.createToken(f.TokenType.SLASH);case w.Char.EQUAL:return this.createToken(f.TokenType.EQUAL);case w.Char.COMMA:return this.createToken(f.TokenType.COMMA);case w.Char.DOUBLE_COLON:return this.createToken(f.TokenType.EQUAL);case w.Char.OPEN_PARAN:return this.createToken(f.TokenType.OPEN_PARAN);case w.Char.CLOSE_PARAN:return this.createToken(f.TokenType.CLOSE_PARAN);case w.Char.CAP:return this.createToken(f.TokenType.CAP);case w.Char.PERCENTAGE:return this.createToken(f.TokenType.PERCENTAGE);case w.Char.NEWLINE:return this.createToken(f.TokenType.NEWLINE);default:return g.isDigit(e)?this.number():this.string()}}isAtEnd(){return this.current>=this.source.length}advance(){return this.current++,this.source.charAt(this.current-1)}peek(e){return this.current+e>=this.source.length?"\0":this.source.charAt(this.current+e)}string(){for(;g.isAlpha(this.peek(0))||g.isDigit(this.peek(0));)this.advance();const e=this.lexeme();let t,n;return[t,n]=this.phrases.search(e),n?this.createToken(t):([,n]=this.ttypes.get(e),n?this.createTokenWithLiteral(f.TokenType.UNIT,e):this.createToken(f.TokenType.NAME))}number(){for(;g.isDigit(this.peek(0));)this.advance();if("."===this.peek(0)&&g.isDigit(this.peek(1)))for(this.advance();g.isDigit(this.peek(0));)this.advance();return this.createTokenWithLiteral(f.TokenType.Number,new r.Type.BNumber(this.lexeme()))}createToken(e){return this.createTokenWithLiteral(e,null)}createTokenWithLiteral(e,t){const n=new f.Token(e,this.lexeme(),t,this.start,this.current);return this.start=this.current,this.tokens.push(n),n}lexeme(){return this.source.substring(this.start,this.current)}space(){let e=this.advance();for(;g.isSpace(e);)this.start=this.current,e=this.advance();return e}}N.Lexer=g,g.notAlpha=[w.Char.PLUS,w.Char.MINUS,w.Char.TIMES,w.Char.SLASH,w.Char.OPEN_PARAN,w.Char.CLOSE_PARAN,w.Char.CAP,w.Char.PERCENTAGE,w.Char.EQUAL,w.Char.COMMA,w.Char.DOUBLE_COLON];var E={};Object.defineProperty(E,"__esModule",{value:!0});class v{constructor(){this.depth=0}static createPrefix(e,t){return`${this.prefixchar}${"-".repeat(e*this.tab)} (${e/this.tab})${t}`}visitCallExpr(e){return`${v.createPrefix(this.depth,"Function")} \n|\n${e.name}`}visitAssignExpr(e){this.depth+=v.tab;const t=this.evaluate(e.value);return this.depth-=v.tab,`${v.createPrefix(this.depth,"ASSIGN")} \n|\n${t}`}visitVariableExpr(e){return`${v.createPrefix(this.depth,"VARIABLE")} ${e.name}\n|\n`}visitUnitExpr(e){this.depth+=v.tab;const t=this.evaluate(e.expression);return this.depth-=v.tab,`${v.createPrefix(this.depth,"UNIT")} ${e.unit.unitType} \n|\n${t}`}visitUnitConvertionExpr(e){this.depth+=v.tab;const t=this.evaluate(e.expression);return this.depth-=v.tab,`${v.createPrefix(this.depth,"UNIT CONVERT")} ${e.unit.unitType} \n|\n${t}`}visitBinaryExpr(e){this.depth+=v.tab;const t=this.evaluate(e.left),n=this.evaluate(e.right);return this.depth-=v.tab,`${v.createPrefix(this.depth,"BINARY")}  ${e.operator} \n|\n${t}${n}`}visitGroupingExpr(e){this.depth+=v.tab;const t=this.evaluate(e.expression);return this.depth-=v.tab,`${v.createPrefix(this.depth,"Grouping")} \n|\n${t}`}visitLiteralExpr(e){return`${v.createPrefix(this.depth,"LITERAL")} ${e.value.print()}\n|\n`}visitUnaryExpr(e){this.depth+=v.tab;const t=this.evaluate(e.right);return this.depth-=v.tab,`${v.createPrefix(this.depth,"UNARY")} ${e.operator} \n|\n${t}`}visitPercentageExpr(e){this.depth+=v.tab;const t=this.evaluate(e.expression);return this.depth-=v.tab,`${v.createPrefix(this.depth,"PERCENTAGE")} \n|\n${t}`}print(e){return this.evaluate(e)}evaluate(e){return e.accept(this)}}E.ASTPrinter=v,v.tab=2,v.prefixchar="+";var b={};Object.defineProperty(b,"__esModule",{value:!0});class y extends E.ASTPrinter{constructor(e,t){super(),this.start=e,this.end=t}toString(){return this.print(this)}}b.Expr=y,function(e){e.Binary=class extends e{constructor(e,t,n,r,i){super(r,i),this.left=e,this.operator=t,this.right=n}accept(e){return e.visitBinaryExpr(this)}},e.Grouping=class extends e{constructor(e,t,n){super(t,n),this.expression=e}accept(e){return e.visitGroupingExpr(this)}},e.Assign=class extends e{constructor(e,t,n,r){super(n,r),this.name=e,this.value=t}accept(e){return e.visitAssignExpr(this)}},e.Variable=class extends e{constructor(e,t,n){super(t,n),this.name=e}accept(e){return e.visitVariableExpr(this)}},e.Call=class extends e{constructor(e,t,n,r){super(n,r),this.name=e,this.argument=t}accept(e){return e.visitCallExpr(this)}},e.Literal=class extends e{constructor(e,t,n){super(t,n),this.value=e}accept(e){return e.visitLiteralExpr(this)}},e.Percentage=class extends e{constructor(e,t,n){super(t,n),this.expression=e}accept(e){return e.visitPercentageExpr(this)}},e.UnitExpr=class extends e{constructor(e,t,n,r){super(n,r),this.unit=t,this.expression=e}accept(e){return e.visitUnitExpr(this)}},e.UnitConvertionExpr=class extends e{constructor(e,t,n,r){super(n,r),this.unit=t,this.expression=e}accept(e){return e.visitUnitConvertionExpr(this)}},e.Unary=class extends e{constructor(e,t,n,r){super(n,r),this.operator=e,this.right=t}accept(e){return e.visitUnaryExpr(this)}}}(y=b.Expr||(b.Expr={}));var x={};Object.defineProperty(x,"__esModule",{value:!0}),x.Parser=class{constructor(e,t,n){this.source=e,this.lexer=new N.Lexer(this.source,t,n),this.ntoken=0,this.tokens=[]}parse(){return this.Stmt()}Stmt(){const e=this.assignment();if(this.match(f.TokenType.NEWLINE))return e;if(this.peek().type===f.TokenType.EOL)throw new Error("Expecting new Line");throw new Error(`Unexpected token ${this.peek().lexeme}`)}assignment(){const e=this.expression();if(this.match(f.TokenType.EQUAL)){const t=this.expression();if(e instanceof b.Expr.Variable){const n=e.name;return new b.Expr.Assign(n,t,e.start,t.end)}}return e}expression(){return this.percentage()}percentage(){let e=this.addition();for(;this.match(f.TokenType.OF);){const t=this.previous(),n=this.addition();e=new b.Expr.Binary(e,t,n,e.start,n.end)}return e}addition(){let e=this.multiply();for(;this.match(f.TokenType.PLUS,f.TokenType.MINUS);){const t=this.previous(),n=this.multiply();e=new b.Expr.Binary(e,t,n,e.start,n.end)}return e}multiply(){let e=this.unary();for(;this.match(f.TokenType.TIMES,f.TokenType.SLASH,f.TokenType.MOD,f.TokenType.OF);){const t=this.previous(),n=this.unary();e=new b.Expr.Binary(e,t,n,e.start,n.end)}return e}unary(){if(this.match(f.TokenType.PLUS,f.TokenType.MINUS)){const e=this.previous(),t=this.unary();return new b.Expr.Unary(e,t,e.start,t.end)}return this.exponent()}exponent(){let e=this.unitConvert();for(;this.match(f.TokenType.CAP);){const t=this.previous(),n=this.unary();e=new b.Expr.Binary(e,t,n,e.start,n.end)}return e}unitConvert(){const e=this.suffix();if(this.match(f.TokenType.IN)){this.consume(f.TokenType.UNIT,"Expecting unit after in");const t=this.previous();let n;if([n]=this.lexer.ttypes.get(t.lexeme),null!=n)return new b.Expr.UnitConvertionExpr(e,n,e.start,t.end)}return e}suffix(){const e=this.call();if(this.match(f.TokenType.PERCENTAGE)){const t=this.previous();return new b.Expr.Percentage(e,e.start,t.end)}if(this.match(f.TokenType.UNIT)){const t=this.previous();let n;if([n]=this.lexer.ttypes.get(t.lexeme),null!=n)return new b.Expr.UnitExpr(e,n,e.start,t.end)}return e}call(){const e=this.term();if(this.match(f.TokenType.OPEN_PARAN)){if(e instanceof b.Expr.Variable){const t=Array();if(this.peek().type!==f.TokenType.CLOSE_PARAN)do{if(t.length>=255)throw new Error(`${e.name} function cannot have more than 255 arguments`);t.push(this.expression())}while(this.match(f.TokenType.COMMA));return this.consume(f.TokenType.CLOSE_PARAN,"Expect ')' after the arguments"),new b.Expr.Call(e.name,t,e.start,this.previous().end)}throw new Error("Not callable")}return e}term(){if(this.match(f.TokenType.Number))return new b.Expr.Literal(this.previous().Literal,this.previous().start,this.previous().end);if(this.match(f.TokenType.OPEN_PARAN)){const e=this.previous(),t=this.expression();return this.consume(f.TokenType.CLOSE_PARAN,"Expect ')' after expression"),new b.Expr.Grouping(t,e.start,this.previous().end)}if(this.match(f.TokenType.NAME))return new b.Expr.Variable(this.previous().lexeme,this.previous().start,this.previous().end);throw new Error(`Expect expression but found ${this.peek().lexeme}`)}match(...e){for(const t of e)if(this.check(t))return this.incr(),!0;return!1}consume(e,t){if(!this.check(e))throw new Error(t);this.incr()}check(e){return!this.isAtEnd()&&this.peek().type===e}isAtEnd(){return this.nextToken().type===f.TokenType.EOL}nextToken(){return this.ntoken<this.tokens.length?this.tokens[this.ntoken]:this.getToken()}getToken(){const e=this.lexer.Next();return e.type!==f.TokenType.EOL&&this.tokens.push(e),e}previous(){return this.tokens[this.ntoken-1]}peek(){return this.nextToken()}incr(){this.ntoken++}};var A={};Object.defineProperty(A,"__esModule",{value:!0}),A.Interpreter=class{constructor(e,t,n,r,i){this.parser=new x.Parser(e,t,n),this.environment=r,this.funcations=i,this.ast=this.parser.parse()}visitCallExpr(e){const t=e.name;let n,r;if([n,r]=this.funcations.get(t),r&&null!=n){if(-1!==n.arbity&&n.arbity!==e.argument.length)throw new Error(`function ${t} Expected ${n.arbity} args but got ${e.argument.length}`);const r=Array();for(const t of e.argument)r.push(this.evaluate(t));return n.call(this.environment,...r)}throw Error(`${t} is not callable`)}visitAssignExpr(e){const t=this.evaluate(e.value);return this.environment.set(e.name,t),t}visitVariableExpr(e){return this.environment.get(e.name)}evaluateExpression(){return this.evaluate(this.ast)}visitUnitConvertionExpr(e){const t=this.evaluate(e.expression);if(t instanceof r.Type.Numberic)return r.Type.Units.convertToUnit(t,e.unit);throw new Error("Expecting numeric value before in")}visitUnitExpr(e){const t=this.evaluate(e.expression);if(t instanceof r.Type.Numberic)return r.Type.Units.New(t.number,e.unit);throw new Error("Expecting numeric value before unit")}visitBinaryExpr(e){let t=this.evaluate(e.left);const n=this.evaluate(e.right);switch(e.operator.type){case f.TokenType.PLUS:return t.Add(n);case f.TokenType.MINUS:return t.Sub(n);case f.TokenType.TIMES:return t.times(n);case f.TokenType.SLASH:return t.divide(n);case f.TokenType.MOD:return n.isZero()?new r.Type.BNumber("Infinity"):t.modulo(n);case f.TokenType.CAP:return t.isNegative()&&!n.isInteger()?t.negated().power(n).negated():t.power(n);case f.TokenType.OF:const i=t=new r.Type.Percentage(t.number);return n.number=i.percentageValue(n.number),n;default:return r.Type.BNumber.ZERO}}visitGroupingExpr(e){return this.evaluate(e.expression)}visitLiteralExpr(e){return e.value}visitUnaryExpr(e){const t=this.evaluate(e.right);return e.operator.type===f.TokenType.MINUS?t.negated():t}visitPercentageExpr(e){const t=this.evaluate(e.expression);if(t instanceof r.Type.Numberic)return r.Type.Percentage.New(t.number);throw new Error("Expecting numeric value in percentage")}setValues(e){for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];this.environment.set(t,n)}}evaluate(e){return e.accept(this)}};var P={};Object.defineProperty(P,"__esModule",{value:!0});class k{constructor(e,...t){this.type=e,this.phrases=t}add(...e){for(const t of e)if(this.check(t))throw new Error(`${t} already exists`);this.phrases.push(...e)}check(...e){for(const t of this.phrases)for(const n of e)if(n===t)return!0;return!1}}P.Phrases=class{constructor(){this.phrases=[]}add(...e){this.phrases.push(...e)}getPhrases(e){for(const t of this.phrases)if(t.type===e)return[t.phrases,!0];return[[],!1]}search(e){e=e.toUpperCase();for(const t of this.phrases)if(t.phrases.find(t=>t===e))return[t.type,!0];return[0,!1]}addPhrases(e,...t){if(t=t.map(e=>e.toUpperCase()),this.checkPhrase(...t))throw new Error("phrases already exits");for(const n of this.phrases)n.type===e&&n.phrases.push(...t);this.add(new k(e,...t))}checkPhrase(...e){for(const t of this.phrases)if(t.check(...e))return!0;return!1}};var M={};Object.defineProperty(M,"__esModule",{value:!0}),M.Environment=l.Environment,M.FcalFunctions=s.FcalFunctions,M.Type=r.Type,M.TType=u.TType;class O{constructor(){this.phrases=O.getdefaultphrases(),this.ttypes=h.getdefaultTTypes(),this.environment=new l.Environment,this.setDefaultValues(),this.functions=new s.FcalFunctions,this.setDefaultFunctions()}static getdefaultphrases(){const e=new P.Phrases;return e.addPhrases(f.TokenType.PLUS,"PLUS","AND","WITH","ADD"),e.addPhrases(f.TokenType.MINUS,"MINUS","SUBTRACT","WITHOUT"),e.addPhrases(f.TokenType.TIMES,"TIMES","x","MULTIPLIEDBY","mul"),e.addPhrases(f.TokenType.SLASH,"DIVIDE","DIVIDEBY"),e.addPhrases(f.TokenType.CAP,"POW"),e.addPhrases(f.TokenType.MOD,"mod"),e.addPhrases(f.TokenType.OF,"of","as"),e.addPhrases(f.TokenType.IN,"in"),e}evaluate(e){return e=S(e),new A.Interpreter(e,this.phrases,this.ttypes,this.environment,this.functions).evaluateExpression()}expression(e){const t=new l.Environment;return t.values=Object.assign({},this.environment.values),e=S(e),new C(new A.Interpreter(e,this.phrases,this.ttypes,t,this.functions))}expressionWithContext(e){return e=S(e),new C(new A.Interpreter(e,this.phrases,this.ttypes,this.environment,this.functions))}setValues(e){for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];this.environment.set(t,n)}}setFunctions(e){for(const t of e.functions)this.functions.add(t)}setDefaultValues(){this.setValues({E:r.Type.BNumber.New("2.718281828459045235360287"),PI:r.Type.BNumber.New("3.141592653589793238462645"),PI2:r.Type.BNumber.New("6.28318530718")})}setDefaultFunctions(){this.setFunctions(o.getDefaultFunction())}}function S(e){return e.endsWith("\n")?e:e+"\n"}M.Fcal=O;class C{constructor(e){this.interpreter=e}evaluate(){return this.interpreter.evaluateExpression()}setValues(e){this.interpreter.setValues(e)}}return M.Expression=C,M});