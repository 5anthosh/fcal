!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).fcal=e()}}(function(){var e={exports:{}};!function(t){"use strict";var n,r,i,o,s=9e15,u=1e9,a="0123456789abcdef",c="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",h="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",p={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-s,maxE:s,crypto:!1},f=!0,l="[DecimalError] ",d=l+"Invalid argument: ",m=l+"Precision limit exceeded",v=l+"crypto unavailable",w=Math.floor,E=Math.pow,g=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,y=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,N=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,T=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,b=1e7,P=7,A=c.length-1,x=h.length-1,k={name:"[object Decimal]"};function U(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",(n=P-r.length)&&(o+=Y(n)),o+=r;s=e[t],(n=P-(r=s+"").length)&&(o+=Y(n))}else if(0===s)return"0";for(;s%10==0;)s/=10;return o+s}function S(e,t,n){if(e!==~~e||e<t||e>n)throw Error(d+e)}function M(e,t,n,r){var i,o,s,u;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=P,i=0):(i=Math.ceil((t+1)/P),t%=P),o=E(10,P-t),u=e[i]%o|0,null==r?t<3?(0==t?u=u/100|0:1==t&&(u=u/10|0),s=n<4&&99999==u||n>3&&49999==u||5e4==u||0==u):s=(n<4&&u+1==o||n>3&&u+1==o/2)&&(e[i+1]/o/100|0)==E(10,t-2)-1||(u==o/2||0==u)&&0==(e[i+1]/o/100|0):t<4?(0==t?u=u/1e3|0:1==t?u=u/100|0:2==t&&(u=u/10|0),s=(r||n<4)&&9999==u||!r&&n>3&&4999==u):s=((r||n<4)&&u+1==o||!r&&n>3&&u+1==o/2)&&(e[i+1]/o/1e3|0)==E(10,t-3)-1,s}function F(e,t,n){for(var r,i,o=[0],s=0,u=e.length;s<u;){for(i=o.length;i--;)o[i]*=t;for(o[0]+=a.indexOf(e.charAt(s++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}k.absoluteValue=k.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),C(e)},k.ceil=function(){return C(new this.constructor(this),this.e+1,2)},k.comparedTo=k.cmp=function(e){var t,n,r,i,o=this,s=o.d,u=(e=new o.constructor(e)).d,a=o.s,c=e.s;if(!s||!u)return a&&c?a!==c?a:s===u?0:!s^a<0?1:-1:NaN;if(!s[0]||!u[0])return s[0]?a:u[0]?-c:0;if(a!==c)return a;if(o.e!==e.e)return o.e>e.e^a<0?1:-1;for(t=0,n=(r=s.length)<(i=u.length)?r:i;t<n;++t)if(s[t]!==u[t])return s[t]>u[t]^a<0?1:-1;return r===i?0:r>i^a<0?1:-1},k.cosine=k.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+P,r.rounding=1,n=function(e,t){var n,r,i=t.d.length;i<32?r=(1/Q(4,n=Math.ceil(i/3))).toString():(n=16,r="2.3283064365386962890625e-10"),e.precision+=n,t=Z(e,1,t.times(r),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}(r,$(r,n)),r.precision=e,r.rounding=t,C(2==o||3==o?n.neg():n,e,t,!0)):new r(1):new r(NaN)},k.cubeRoot=k.cbrt=function(){var e,t,n,r,i,o,s,u,a,c,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(f=!1,(o=h.s*E(h.s*h,1/3))&&Math.abs(o)!=1/0?r=new p(o.toString()):(n=U(h.d),(o=((e=h.e)-n.length+1)%3)&&(n+=1==o||-2==o?"0":"00"),o=E(n,1/3),e=w((e+1)/3)-(e%3==(e<0?-1:2)),(r=new p(n=o==1/0?"5e"+e:(n=o.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=h.s),s=(e=p.precision)+3;;)if(c=(a=(u=r).times(u).times(u)).plus(h),r=O(c.plus(h).times(u),c.plus(a),s+2,1),U(u.d).slice(0,s)===(n=U(r.d)).slice(0,s)){if("9999"!=(n=n.slice(s-3,s+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(C(r,e+1,1),t=!r.times(r).times(r).eq(h));break}if(!i&&(C(u,e+1,0),u.times(u).times(u).eq(h))){r=u;break}s+=4,i=1}return f=!0,C(r,e,p.rounding,t)},k.decimalPlaces=k.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=((e=t.length-1)-w(this.e/P))*P,e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},k.dividedBy=k.div=function(e){return O(this,new this.constructor(e))},k.dividedToIntegerBy=k.divToInt=function(e){var t=this.constructor;return C(O(this,new t(e),0,1,1),t.precision,t.rounding)},k.equals=k.eq=function(e){return 0===this.cmp(e)},k.floor=function(){return C(new this.constructor(this),this.e+1,3)},k.greaterThan=k.gt=function(e){return this.cmp(e)>0},k.greaterThanOrEqualTo=k.gte=function(e){var t=this.cmp(e);return 1==t||0===t},k.hyperbolicCosine=k.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,u=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return u;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,(i=o.d.length)<32?t=(1/Q(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),o=Z(s,1,o.times(t),new s(1),!0);for(var a,c=e,h=new s(8);c--;)a=o.times(o),o=u.minus(a.times(h.minus(a.times(h))));return C(o,s.precision=n,s.rounding=r,!0)},k.hyperbolicSine=k.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,(r=i.d.length)<3)i=Z(o,2,i,i,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,i=Z(o,2,i=i.times(1/Q(5,e)),i,!0);for(var s,u=new o(5),a=new o(16),c=new o(20);e--;)s=i.times(i),i=i.times(u.plus(s.times(a.times(s).plus(c))))}return o.precision=t,o.rounding=n,C(i,t,n,!0)},k.hyperbolicTangent=k.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,O(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},k.inverseCosine=k.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return-1!==r?0===r?t.isNeg()?_(n,i,o):new n(0):new n(NaN):t.isZero()?_(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=_(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))},k.inverseHyperbolicCosine=k.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,f=!1,n=n.times(n).minus(1).sqrt().plus(n),f=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},k.inverseHyperbolicSine=k.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,f=!1,n=n.times(n).plus(1).sqrt().plus(n),f=!0,r.precision=e,r.rounding=t,n.ln())},k.inverseHyperbolicTangent=k.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?C(new o(i),e,t,!0):(o.precision=n=r-i.e,i=O(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)},k.inverseSine=k.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,-1!==t?0===t?((e=_(o,n+4,r).times(.5)).s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))},k.inverseTangent=k.atan=function(){var e,t,n,r,i,o,s,u,a,c=this,h=c.constructor,p=h.precision,l=h.rounding;if(c.isFinite()){if(c.isZero())return new h(c);if(c.abs().eq(1)&&p+4<=x)return(s=_(h,p+4,l).times(.25)).s=c.s,s}else{if(!c.s)return new h(NaN);if(p+4<=x)return(s=_(h,p+4,l).times(.5)).s=c.s,s}for(h.precision=u=p+10,h.rounding=1,e=n=Math.min(28,u/P+2|0);e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(f=!1,t=Math.ceil(u/P),r=1,a=c.times(c),s=new h(c),i=c;-1!==e;)if(i=i.times(a),o=s.minus(i.div(r+=2)),i=i.times(a),void 0!==(s=o.plus(i.div(r+=2))).d[t])for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),f=!0,C(s,h.precision=p,h.rounding=l,!0)},k.isFinite=function(){return!!this.d},k.isInteger=k.isInt=function(){return!!this.d&&w(this.e/P)>this.d.length-2},k.isNaN=function(){return!this.s},k.isNegative=k.isNeg=function(){return this.s<0},k.isPositive=k.isPos=function(){return this.s>0},k.isZero=function(){return!!this.d&&0===this.d[0]},k.lessThan=k.lt=function(e){return this.cmp(e)<0},k.lessThanOrEqualTo=k.lte=function(e){return this.cmp(e)<1},k.logarithm=k.log=function(e){var t,n,r,i,o,s,u,a,c=this.constructor,h=c.precision,p=c.rounding;if(null==e)e=new c(10),t=!0;else{if(n=(e=new c(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new c(NaN);t=e.eq(10)}if(n=this.d,this.s<0||!n||!n[0]||this.eq(1))return new c(n&&!n[0]?-1/0:1!=this.s?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10==0;)i/=10;o=1!==i}if(f=!1,s=K(this,u=h+5),r=t?D(c,u+10):K(e,u),M((a=O(s,r,u,1)).d,i=h,p))do{if(s=K(this,u+=10),r=t?D(c,u+10):K(e,u),a=O(s,r,u,1),!o){+U(a.d).slice(i+1,i+15)+1==1e14&&(a=C(a,h+1,0));break}}while(M(a.d,i+=10,p));return f=!0,C(a,h,p)},k.minus=k.sub=function(e){var t,n,r,i,o,s,u,a,c,h,p,l,d=this,m=d.constructor;if(e=new m(e),!d.d||!e.d)return d.s&&e.s?d.d?e.s=-e.s:e=new m(e.d||d.s!==e.s?d:NaN):e=new m(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(c=d.d,l=e.d,u=m.precision,a=m.rounding,!c[0]||!l[0]){if(l[0])e.s=-e.s;else{if(!c[0])return new m(3===a?-0:0);e=new m(d)}return f?C(e,u,a):e}if(n=w(e.e/P),h=w(d.e/P),c=c.slice(),o=h-n){for((p=o<0)?(t=c,o=-o,s=l.length):(t=l,n=h,s=c.length),o>(r=Math.max(Math.ceil(u/P),s)+2)&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for((p=(r=c.length)<(s=l.length))&&(s=r),r=0;r<s;r++)if(c[r]!=l[r]){p=c[r]<l[r];break}o=0}for(p&&(t=c,c=l,l=t,e.s=-e.s),s=c.length,r=l.length-s;r>0;--r)c[s++]=0;for(r=l.length;r>o;){if(c[--r]<l[r]){for(i=r;i&&0===c[--i];)c[i]=b-1;--c[i],c[r]+=b}c[r]-=l[r]}for(;0===c[--s];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=L(c,n),f?C(e,u,a):e):new m(3===a?-0:0)},k.modulo=k.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?C(new r(n),r.precision,r.rounding):(f=!1,9==r.modulo?(t=O(n,e.abs(),0,3,1)).s*=e.s:t=O(n,e,0,r.modulo,1),t=t.times(e),f=!0,n.minus(t))},k.naturalExponential=k.exp=function(){return H(this)},k.naturalLogarithm=k.ln=function(){return K(this)},k.negated=k.neg=function(){var e=new this.constructor(this);return e.s=-e.s,C(e)},k.plus=k.add=function(e){var t,n,r,i,o,s,u,a,c,h,p=this,l=p.constructor;if(e=new l(e),!p.d||!e.d)return p.s&&e.s?p.d||(e=new l(e.d||p.s===e.s?p:NaN)):e=new l(NaN),e;if(p.s!=e.s)return e.s=-e.s,p.minus(e);if(c=p.d,h=e.d,u=l.precision,a=l.rounding,!c[0]||!h[0])return h[0]||(e=new l(p)),f?C(e,u,a):e;if(o=w(p.e/P),r=w(e.e/P),c=c.slice(),i=o-r){for(i<0?(n=c,i=-i,s=h.length):(n=h,r=o,s=c.length),i>(s=(o=Math.ceil(u/P))>s?o+1:s+1)&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((s=c.length)-(i=h.length)<0&&(i=s,n=h,h=c,c=n),t=0;i;)t=(c[--i]=c[i]+h[i]+t)/b|0,c[i]%=b;for(t&&(c.unshift(t),++r),s=c.length;0==c[--s];)c.pop();return e.d=c,e.e=L(c,r),f?C(e,u,a):e},k.precision=k.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(d+e);return n.d?(t=I(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},k.round=function(){var e=this,t=e.constructor;return C(new t(e),e.e+1,t.rounding)},k.sine=k.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+P,r.rounding=1,n=function(e,t){var n,r=t.d.length;if(r<3)return Z(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=Z(e,2,t=t.times(1/Q(5,n)),t);for(var i,o=new e(5),s=new e(16),u=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(u))));return t}(r,$(r,n)),r.precision=e,r.rounding=t,C(o>2?n.neg():n,e,t,!0)):new r(NaN)},k.squareRoot=k.sqrt=function(){var e,t,n,r,i,o,s=this,u=s.d,a=s.e,c=s.s,h=s.constructor;if(1!==c||!u||!u[0])return new h(!c||c<0&&(!u||u[0])?NaN:u?s:1/0);for(f=!1,0==(c=Math.sqrt(+s))||c==1/0?(((t=U(u)).length+a)%2==0&&(t+="0"),c=Math.sqrt(t),a=w((a+1)/2)-(a<0||a%2),r=new h(t=c==1/0?"1e"+a:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+a)):r=new h(c.toString()),n=(a=h.precision)+3;;)if(r=(o=r).plus(O(s,o,n+2,1)).times(.5),U(o.d).slice(0,n)===(t=U(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(C(r,a+1,1),e=!r.times(r).eq(s));break}if(!i&&(C(o,a+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}return f=!0,C(r,a,h.rounding,e)},k.tangent=k.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=O(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,C(2==o||4==o?n.neg():n,e,t,!0)):new r(NaN)},k.times=k.mul=function(e){var t,n,r,i,o,s,u,a,c,h=this,p=h.constructor,l=h.d,d=(e=new p(e)).d;if(e.s*=h.s,!(l&&l[0]&&d&&d[0]))return new p(!e.s||l&&!l[0]&&!d||d&&!d[0]&&!l?NaN:l&&d?0*e.s:e.s/0);for(n=w(h.e/P)+w(e.e/P),(a=l.length)<(c=d.length)&&(o=l,l=d,d=o,s=a,a=c,c=s),o=[],r=s=a+c;r--;)o.push(0);for(r=c;--r>=0;){for(t=0,i=a+r;i>r;)u=o[i]+d[r]*l[i-r-1]+t,o[i--]=u%b|0,t=u/b|0;o[i]=(o[i]+t)%b|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=L(o,n),f?C(e,p.precision,p.rounding):e},k.toBinary=function(e,t){return J(this,2,e,t)},k.toDecimalPlaces=k.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(S(e,0,u),void 0===t?t=r.rounding:S(t,0,8),C(n,e+n.e+1,t))},k.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=R(r,!0):(S(e,0,u),void 0===t?t=i.rounding:S(t,0,8),n=R(r=C(new i(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},k.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return void 0===e?n=R(i):(S(e,0,u),void 0===t?t=o.rounding:S(t,0,8),n=R(r=C(new o(i),e+i.e+1,t),!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},k.toFraction=function(e){var t,n,r,i,o,s,u,a,c,h,p,l,m=this,v=m.d,w=m.constructor;if(!v)return new w(m);if(c=n=new w(1),r=a=new w(0),s=(o=(t=new w(r)).e=I(v)-m.e-1)%P,t.d[0]=E(10,s<0?P+s:s),null==e)e=o>0?t:c;else{if(!(u=new w(e)).isInt()||u.lt(c))throw Error(d+u);e=u.gt(t)?o>0?t:c:u}for(f=!1,u=new w(U(v)),h=w.precision,w.precision=o=v.length*P*2;p=O(u,t,0,1,1),1!=(i=n.plus(p.times(r))).cmp(e);)n=r,r=i,i=c,c=a.plus(p.times(i)),a=i,i=t,t=u.minus(p.times(i)),u=i;return i=O(e.minus(n),r,0,1,1),a=a.plus(i.times(c)),n=n.plus(i.times(r)),a.s=c.s=m.s,l=O(c,r,o,1).minus(m).abs().cmp(O(a,n,o,1).minus(m).abs())<1?[c,r]:[a,n],w.precision=h,f=!0,l},k.toHexadecimal=k.toHex=function(e,t){return J(this,16,e,t)},k.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:S(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(f=!1,n=O(n,e,0,t,1).times(e),f=!0,C(n)):(e.s=n.s,n=e),n},k.toNumber=function(){return+this},k.toOctal=function(e,t){return J(this,8,e,t)},k.toPower=k.pow=function(e){var t,n,r,i,o,s,u=this,a=u.constructor,c=+(e=new a(e));if(!(u.d&&e.d&&u.d[0]&&e.d[0]))return new a(E(+u,c));if((u=new a(u)).eq(1))return u;if(r=a.precision,o=a.rounding,e.eq(1))return C(u,r,o);if((t=w(e.e/P))>=e.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return i=B(a,u,n,r),e.s<0?new a(1).div(i):C(i,r,o);if((s=u.s)<0){if(t<e.d.length-1)return new a(NaN);if(0==(1&e.d[t])&&(s=1),0==u.e&&1==u.d[0]&&1==u.d.length)return u.s=s,u}return(t=0!=(n=E(+u,c))&&isFinite(n)?new a(n+"").e:w(c*(Math.log("0."+U(u.d))/Math.LN10+u.e+1)))>a.maxE+1||t<a.minE-1?new a(t>0?s/0:0):(f=!1,a.rounding=u.s=1,n=Math.min(12,(t+"").length),(i=H(e.times(K(u,r+n)),r)).d&&M((i=C(i,r+5,1)).d,r,o)&&(t=r+10,+U((i=C(H(e.times(K(u,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=C(i,r+1,0))),i.s=s,f=!0,a.rounding=o,C(i,r,o))},k.toPrecision=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=R(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(S(e,1,u),void 0===t?t=i.rounding:S(t,0,8),n=R(r=C(new i(r),e,t),e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},k.toSignificantDigits=k.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(S(e,1,u),void 0===t?t=n.rounding:S(t,0,8)),C(new n(this),e,t)},k.toString=function(){var e=this,t=e.constructor,n=R(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},k.truncated=k.trunc=function(){return C(new this.constructor(this),this.e+1,1)},k.valueOf=k.toJSON=function(){var e=this,t=e.constructor,n=R(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var O=function(){function e(e,t,n){var r,i=0,o=e.length;for(e=e.slice();o--;)r=e[o]*t+i,e[o]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(i,o,s,u,a,c){var h,p,f,l,d,m,v,E,g,y,N,T,A,x,k,U,S,M,F,O,R=i.constructor,L=i.s==o.s?1:-1,D=i.d,_=o.d;if(!(D&&D[0]&&_&&_[0]))return new R(i.s&&o.s&&(D?!_||D[0]!=_[0]:_)?D&&0==D[0]||!_?0*L:L/0:NaN);for(c?(d=1,p=i.e-o.e):(c=b,d=P,p=w(i.e/d)-w(o.e/d)),F=_.length,S=D.length,y=(g=new R(L)).d=[],f=0;_[f]==(D[f]||0);f++);if(_[f]>(D[f]||0)&&p--,null==s?(x=s=R.precision,u=R.rounding):x=a?s+(i.e-o.e)+1:s,x<0)y.push(1),m=!0;else{if(x=x/d+2|0,f=0,1==F){for(l=0,_=_[0],x++;(f<S||l)&&x--;f++)k=l*c+(D[f]||0),y[f]=k/_|0,l=k%_|0;m=l||f<S}else{for((l=c/(_[0]+1)|0)>1&&(_=e(_,l,c),D=e(D,l,c),F=_.length,S=D.length),U=F,T=(N=D.slice(0,F)).length;T<F;)N[T++]=0;(O=_.slice()).unshift(0),M=_[0],_[1]>=c/2&&++M;do{l=0,(h=t(_,N,F,T))<0?(A=N[0],F!=T&&(A=A*c+(N[1]||0)),(l=A/M|0)>1?(l>=c&&(l=c-1),1==(h=t(v=e(_,l,c),N,E=v.length,T=N.length))&&(l--,n(v,F<E?O:_,E,c))):(0==l&&(h=l=1),v=_.slice()),(E=v.length)<T&&v.unshift(0),n(N,v,T,c),-1==h&&(h=t(_,N,F,T=N.length))<1&&(l++,n(N,F<T?O:_,T,c)),T=N.length):0===h&&(l++,N=[0]),y[f++]=l,h&&N[0]?N[T++]=D[U]||0:(N=[D[U]],T=1)}while((U++<S||void 0!==N[0])&&x--);m=void 0!==N[0]}y[0]||y.shift()}if(1==d)g.e=p,r=m;else{for(f=1,l=y[0];l>=10;l/=10)f++;g.e=f+p*d-1,C(g,a?s+g.e+1:s,u,m)}return g}}();function C(e,t,n,r){var i,o,s,u,a,c,h,p,l,d=e.constructor;e:if(null!=t){if(!(p=e.d))return e;for(i=1,u=p[0];u>=10;u/=10)i++;if((o=t-i)<0)o+=P,s=t,a=(h=p[l=0])/E(10,i-s-1)%10|0;else if((l=Math.ceil((o+1)/P))>=(u=p.length)){if(!r)break e;for(;u++<=l;)p.push(0);h=a=0,i=1,s=(o%=P)-P+1}else{for(h=u=p[l],i=1;u>=10;u/=10)i++;a=(s=(o%=P)-P+i)<0?0:h/E(10,i-s-1)%10|0}if(r=r||t<0||void 0!==p[l+1]||(s<0?h:h%E(10,i-s-1)),c=n<4?(a||r)&&(0==n||n==(e.s<0?3:2)):a>5||5==a&&(4==n||r||6==n&&(o>0?s>0?h/E(10,i-s):0:p[l-1])%10&1||n==(e.s<0?8:7)),t<1||!p[0])return p.length=0,c?(t-=e.e+1,p[0]=E(10,(P-t%P)%P),e.e=-t||0):p[0]=e.e=0,e;if(0==o?(p.length=l,u=1,l--):(p.length=l+1,u=E(10,P-o),p[l]=s>0?(h/E(10,i-s)%E(10,s)|0)*u:0),c)for(;;){if(0==l){for(o=1,s=p[0];s>=10;s/=10)o++;for(s=p[0]+=u,u=1;s>=10;s/=10)u++;o!=u&&(e.e++,p[0]==b&&(p[0]=1));break}if(p[l]+=u,p[l]!=b)break;p[l--]=0,u=1}for(o=p.length;0===p[--o];)p.pop()}return f&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function R(e,t,n){if(!e.isFinite())return V(e);var r,i=e.e,o=U(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+Y(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+Y(-i-1)+o,n&&(r=n-s)>0&&(o+=Y(r))):i>=s?(o+=Y(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+Y(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=Y(r))),o}function L(e,t){var n=e[0];for(t*=P;n>=10;n/=10)t++;return t}function D(e,t,n){if(t>A)throw f=!0,n&&(e.precision=n),Error(m);return C(new e(c),t,1,!0)}function _(e,t,n){if(t>x)throw Error(m);return C(new e(h),t,n,!0)}function I(e){var t=e.length-1,n=t*P+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function Y(e){for(var t="";e--;)t+="0";return t}function B(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/P+4);for(f=!1;;){if(n%2&&z((o=o.times(t)).d,s)&&(i=!0),0===(n=w(n/2))){n=o.d.length-1,i&&0===o.d[n]&&++o.d[n];break}z((t=t.times(t)).d,s)}return f=!0,o}function W(e){return 1&e.d[e.d.length-1]}function G(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;){if(!(r=new e(t[o])).s){i=r;break}i[n](r)&&(i=r)}return i}function H(e,t){var n,r,i,o,s,u,a,c=0,h=0,p=0,l=e.constructor,d=l.rounding,m=l.precision;if(!e.d||!e.d[0]||e.e>17)return new l(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(f=!1,a=m):a=t,u=new l(.03125);e.e>-2;)e=e.times(u),p+=5;for(a+=r=Math.log(E(2,p))/Math.LN10*2+5|0,n=o=s=new l(1),l.precision=a;;){if(o=C(o.times(e),a,1),n=n.times(++h),U((u=s.plus(O(o,n,a,1))).d).slice(0,a)===U(s.d).slice(0,a)){for(i=p;i--;)s=C(s.times(s),a,1);if(null!=t)return l.precision=m,s;if(!(c<3&&M(s.d,a-r,d,c)))return C(s,l.precision=m,d,f=!0);l.precision=a+=10,n=o=u=new l(1),h=0,c++}s=u}}function K(e,t){var n,r,i,o,s,u,a,c,h,p,l,d=1,m=e,v=m.d,w=m.constructor,E=w.rounding,g=w.precision;if(m.s<0||!v||!v[0]||!m.e&&1==v[0]&&1==v.length)return new w(v&&!v[0]?-1/0:1!=m.s?NaN:v?0:m);if(null==t?(f=!1,h=g):h=t,w.precision=h+=10,r=(n=U(v)).charAt(0),!(Math.abs(o=m.e)<15e14))return c=D(w,h+2,g).times(o+""),m=K(new w(r+"."+n.slice(1)),h-10).plus(c),w.precision=g,null==t?C(m,g,E,f=!0):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=U((m=m.times(e)).d)).charAt(0),d++;for(o=m.e,r>1?(m=new w("0."+n),o++):m=new w(r+"."+n.slice(1)),p=m,a=s=m=O(m.minus(1),m.plus(1),h,1),l=C(m.times(m),h,1),i=3;;){if(s=C(s.times(l),h,1),U((c=a.plus(O(s,new w(i),h,1))).d).slice(0,h)===U(a.d).slice(0,h)){if(a=a.times(2),0!==o&&(a=a.plus(D(w,h+2,g).times(o+""))),a=O(a,new w(d),h,1),null!=t)return w.precision=g,a;if(!M(a.d,h-10,E,u))return C(a,w.precision=g,E,f=!0);w.precision=h+=10,c=s=m=O(p.minus(1),p.plus(1),h,1),l=C(m.times(m),h,1),i=u=1}a=c,i+=2}}function V(e){return String(e.s*e.s/0)}function q(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%P,n<0&&(r+=P),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=P;r<i;)e.d.push(+t.slice(r,r+=P));t=t.slice(r),r=P-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),f&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function j(e,t){var r,i,o,s,u,a,c,h,p;if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(y.test(t))r=16,t=t.toLowerCase();else if(g.test(t))r=2;else{if(!N.test(t))throw Error(d+t);r=8}for((s=t.search(/p/i))>0?(c=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),u=(s=t.indexOf("."))>=0,i=e.constructor,u&&(s=(a=(t=t.replace(".","")).length)-s,o=B(i,new i(r),s,2*s)),s=p=(h=F(t,r,b)).length-1;0===h[s];--s)h.pop();return s<0?new i(0*e.s):(e.e=L(h,p),e.d=h,f=!1,u&&(e=O(e,o,4*a)),c&&(e=e.times(Math.abs(c)<54?E(2,c):n.pow(2,c))),f=!0,e)}function Z(e,t,n,r,i){var o,s,u,a,c=e.precision,h=Math.ceil(c/P);for(f=!1,a=n.times(n),u=new e(r);;){if(s=O(u.times(a),new e(t++*t++),c,1),u=i?r.plus(s):r.minus(s),r=O(s.times(a),new e(t++*t++),c,1),void 0!==(s=u.plus(r)).d[h]){for(o=h;s.d[o]===u.d[o]&&o--;);if(-1==o)break}o=u,u=r,r=s,s=o}return f=!0,s.d.length=h+1,s}function Q(e,t){for(var n=e;--t;)n*=e;return n}function $(e,t){var n,r=t.s<0,i=_(e,e.precision,1),s=i.times(.5);if((t=t.abs()).lte(s))return o=r?4:1,t;if((n=t.divToInt(i)).isZero())o=r?3:2;else{if((t=t.minus(n.times(i))).lte(s))return o=W(n)?r?2:3:r?4:1,t;o=W(n)?r?1:4:r?3:2}return t.minus(i).abs()}function J(e,t,n,i){var o,s,c,h,p,f,l,d,m,v=e.constructor,w=void 0!==n;if(w?(S(n,1,u),void 0===i?i=v.rounding:S(i,0,8)):(n=v.precision,i=v.rounding),e.isFinite()){for(w?(o=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):o=t,(c=(l=R(e)).indexOf("."))>=0&&(l=l.replace(".",""),(m=new v(1)).e=l.length-c,m.d=F(R(m),10,o),m.e=m.d.length),s=p=(d=F(l,10,o)).length;0==d[--p];)d.pop();if(d[0]){if(c<0?s--:((e=new v(e)).d=d,e.e=s,d=(e=O(e,m,n,i,0,o)).d,s=e.e,f=r),c=d[n],h=o/2,f=f||void 0!==d[n+1],f=i<4?(void 0!==c||f)&&(0===i||i===(e.s<0?3:2)):c>h||c===h&&(4===i||f||6===i&&1&d[n-1]||i===(e.s<0?8:7)),d.length=n,f)for(;++d[--n]>o-1;)d[n]=0,n||(++s,d.unshift(1));for(p=d.length;!d[p-1];--p);for(c=0,l="";c<p;c++)l+=a.charAt(d[c]);if(w){if(p>1)if(16==t||8==t){for(c=16==t?4:3,--p;p%c;p++)l+="0";for(p=(d=F(l,o,t)).length;!d[p-1];--p);for(c=1,l="1.";c<p;c++)l+=a.charAt(d[c])}else l=l.charAt(0)+"."+l.slice(1);l=l+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)l="0"+l;l="0."+l}else if(++s>p)for(s-=p;s--;)l+="0";else s<p&&(l=l.slice(0,s)+"."+l.slice(s))}else l=w?"0p+0":"0";l=(16==t?"0x":2==t?"0b":8==t?"0o":"")+l}else l=V(e);return e.s<0?"-"+l:l}function z(e,t){if(e.length>t)return e.length=t,!0}function X(e){return new this(e).abs()}function ee(e){return new this(e).acos()}function te(e){return new this(e).acosh()}function ne(e,t){return new this(e).plus(t)}function re(e){return new this(e).asin()}function ie(e){return new this(e).asinh()}function oe(e){return new this(e).atan()}function se(e){return new this(e).atanh()}function ue(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?_(this,r,i):new this(0)).s=e.s:!e.d||t.isZero()?(n=_(this,o,1).times(.5)).s=e.s:t.s<0?(this.precision=o,this.rounding=1,n=this.atan(O(e,t,o,1)),t=_(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(O(e,t,o,1)):(n=_(this,o,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function ae(e){return new this(e).cbrt()}function ce(e){return C(e=new this(e),e.e+1,2)}function he(e){if(!e||"object"!=typeof e)throw Error(l+"Object expected");var t,n,r,i=!0===e.defaults,o=["precision",1,u,"rounding",0,8,"toExpNeg",-s,0,"toExpPos",0,s,"maxE",0,s,"minE",-s,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=p[n]),void 0!==(r=e[n])){if(!(w(r)===r&&r>=o[t+1]&&r<=o[t+2]))throw Error(d+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=p[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(d+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(v);this[n]=!0}else this[n]=!1}return this}function pe(e){return new this(e).cos()}function fe(e){return new this(e).cosh()}function le(e,t){return new this(e).div(t)}function de(e){return new this(e).exp()}function me(e){return C(e=new this(e),e.e+1,3)}function ve(){var e,t,n=new this(0);for(f=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return f=!0,new this(1/0);n=t}return f=!0,n.sqrt()}function we(e){return e instanceof n||e&&"[object Decimal]"===e.name||!1}function Ee(e){return new this(e).ln()}function ge(e,t){return new this(e).log(t)}function ye(e){return new this(e).log(2)}function Ne(e){return new this(e).log(10)}function Te(){return G(this,arguments,"lt")}function be(){return G(this,arguments,"gt")}function Pe(e,t){return new this(e).mod(t)}function Ae(e,t){return new this(e).mul(t)}function xe(e,t){return new this(e).pow(t)}function ke(e){var t,n,r,i,o=0,s=new this(1),a=[];if(void 0===e?e=this.precision:S(e,1,u),r=Math.ceil(e/P),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)(i=t[o])>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else{if(!crypto.randomBytes)throw Error(v);for(t=crypto.randomBytes(r*=4);o<r;)(i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((127&t[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else for(;o<r;)a[o++]=1e7*Math.random()|0;for(r=a[--o],e%=P,r&&e&&(i=E(10,P-e),a[o]=(r/i|0)*i);0===a[o];o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;0===a[0];n-=P)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<P&&(n-=P-r)}return s.e=n,s.d=a,s}function Ue(e){return C(e=new this(e),e.e+1,this.rounding)}function Se(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function Me(e){return new this(e).sin()}function Fe(e){return new this(e).sinh()}function Oe(e){return new this(e).sqrt()}function Ce(e,t){return new this(e).sub(t)}function Re(e){return new this(e).tan()}function Le(e){return new this(e).tanh()}function De(e){return C(e=new this(e),e.e+1,1)}(n=function e(t){var n,r,i;function o(e){var t,n,r,i=this;if(!(i instanceof o))return new o(e);if(i.constructor=o,e instanceof o)return i.s=e.s,void(f?!e.d||e.e>o.maxE?(i.e=NaN,i.d=null):e.e<o.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"==(r=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(f?t>o.maxE?(i.e=NaN,i.d=null):t<o.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):q(i,e.toString())}if("string"!==r)throw Error(d+e);return 45===(n=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===n&&(e=e.slice(1)),i.s=1),T.test(e)?q(i,e):j(i,e)}if(o.prototype=k,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=he,o.clone=e,o.isDecimal=we,o.abs=X,o.acos=ee,o.acosh=te,o.add=ne,o.asin=re,o.asinh=ie,o.atan=oe,o.atanh=se,o.atan2=ue,o.cbrt=ae,o.ceil=ce,o.cos=pe,o.cosh=fe,o.div=le,o.exp=de,o.floor=me,o.hypot=ve,o.ln=Ee,o.log=ge,o.log10=Ne,o.log2=ye,o.max=Te,o.min=be,o.mod=Pe,o.mul=Ae,o.pow=xe,o.random=ke,o.round=Ue,o.sign=Se,o.sin=Me,o.sinh=Fe,o.sqrt=Oe,o.sub=Ce,o.tan=Re,o.tanh=Le,o.trunc=De,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return o.config(t),o}(p)).default=n.Decimal=n,c=new n(c),h=new n(h),e.exports?("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(k[Symbol.for("nodejs.util.inspect.custom")]=k.toString,k[Symbol.toStringTag]="Decimal"),e.exports=n):(t||(t="undefined"!=typeof self&&self&&self.self==self?self:window),i=t.Decimal,n.noConflict=function(){return t.Decimal=i,n},t.Decimal=n)}(this),e=e.exports;var t,n={},r=this&&this.__extends||(t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,n)},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(t,n,r){var i=e.call(this,r)||this;return i.start=t,i.end=n,i.name=-1===t?"FcalError":"FcalError ["+t+", "+n+"]",i.message=i.name+": "+r,i}return r(t,e),t.throw=function(e,n){throw t.Error(e,n)},t.throwWithEnd=function(e,n,r){throw t.ErrorWithEnd(e,n,r)},t.throwWithoutCtx=function(e){t.throw(-1,e)},t.Error=function(e,n){return new t(e,e,n)},t.ErrorWithEnd=function(e,n,r){return new t(e,n,r)},t.ErrorWithoutCtx=function(e){return t.Error(-1,e)},t}(Error);n.FcalError=i;var o,s={},u=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(s,"__esModule",{value:!0});var a,c,h=function(){};s.Type=h,function(e){e[e.NUMBER=0]="NUMBER",e[e.UNIT=1]="UNIT",e[e.PERCENTAGE=2]="PERCENTAGE"}(a=s.DATATYPE||(s.DATATYPE={})),function(e){e[e.PERCENTAGE=0]="PERCENTAGE",e[e.NUMBER=1]="NUMBER",e[e.UNIT=2]="UNIT"}(c=s.TYPERANK||(s.TYPERANK={})),function(t){var n=function(t){function n(n){var r=t.call(this)||this;return n instanceof e.Decimal?r.number=n:r.number=new e.Decimal(n),r.leftflag=!1,r}return u(n,t),n.prototype.print=function(){return this.number.toString()},n.prototype.Add=function(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?e.newNumeric(this.plus(e).number):this.plus(e):e.TYPERANK>=this.TYPERANK?e.plus(this):this.newNumeric(e.plus(this).number)},n.prototype.Sub=function(e){return this.Add(e.negated())},n.prototype.times=function(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?e.newNumeric(this.mul(e).number):this.mul(e):e.TYPERANK>=this.TYPERANK?e.mul(this):this.newNumeric(e.mul(this).number)},n.prototype.divide=function(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?this.TYPERANK===e.TYPERANK?this.newNumeric(this.div(e).number):e.newNumeric(this.div(e).number):this.div(e):e.TYPERANK>=this.TYPERANK?e.div(this):this.newNumeric(e.div(this).number)},n.prototype.power=function(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?this.TYPERANK===e.TYPERANK?this.newNumeric(this.pow(e).number):e.newNumeric(this.pow(e).number):this.pow(e):e.TYPERANK>=this.TYPERANK?e.pow(this):this.newNumeric(e.pow(this).number)},n.prototype.modulo=function(e){return this.leftflag=!0,this.TYPE>=e.TYPE?this.TYPERANK<=e.TYPERANK?this.TYPERANK===e.TYPERANK?this.newNumeric(this.mod(e).number):e.newNumeric(this.mod(e).number):this.mod(e):e.TYPERANK>=this.TYPERANK?e.mod(this):this.newNumeric(e.mod(this).number)},n}(t);t.Numberic=n;var r=function(t){function n(e){var n=t.call(this,e)||this;return n.TYPE=a.NUMBER,n.TYPERANK=c.NUMBER,n}return u(n,t),n.New=function(e){return new n(e)},n.prototype.isZero=function(){return this.number.isZero()},n.prototype.isNegative=function(){return this.number.isNegative()},n.prototype.isInteger=function(){return this.number.isInteger()},n.prototype.negated=function(){return n.New(this.number.negated())},n.prototype.div=function(e){return n.New(this.number.div(e.number))},n.prototype.pow=function(e){return n.New(this.number.pow(e.number))},n.prototype.mod=function(e){return n.New(this.number.modulo(e.number))},n.prototype.mul=function(e){return n.New(this.number.mul(e.number))},n.prototype.plus=function(e){return n.New(this.number.plus(e.number))},n.prototype.newNumeric=function(e){return n.New(e)},n.ZERO=n.New(new e.Decimal(0)),n}(n);t.BNumber=r;var i=function(t){function n(e){var n=t.call(this,e)||this;return n.TYPE=a.PERCENTAGE,n.TYPERANK=c.PERCENTAGE,n}return u(n,t),n.New=function(e){return new n(e)},n.prototype.isZero=function(){return this.number.isZero()},n.prototype.isNegative=function(){return this.number.isNegative()},n.prototype.isInteger=function(){return this.number.isInteger()},n.prototype.negated=function(){return n.New(this.number.negated())},n.prototype.plus=function(e){return e.TYPE===a.PERCENTAGE?n.New(this.number.plus(e.number)):n.New(e.number.plus(this.percentageValue(e.number)))},n.prototype.mul=function(e){return e.TYPE===a.PERCENTAGE?n.New(this.number.mul(e.number)):n.New(e.number.mul(this.percentageValue(e.number)))},n.prototype.div=function(e){return e.TYPE===a.PERCENTAGE?n.New(this.number.div(e.number)):e.leftflag?n.New(e.number.div(this.percentageValue(e.number))):n.New(this.percentageValue(e.number).div(e.number))},n.prototype.pow=function(e){return e.TYPE===a.PERCENTAGE?n.New(this.number.pow(e.number)):e.leftflag?n.New(e.number.pow(this.percentageValue(e.number))):n.New(this.percentageValue(e.number).pow(e.number))},n.prototype.mod=function(e){return e.TYPE===a.PERCENTAGE?n.New(this.number.mod(e.number)):e.leftflag?n.New(e.number.mod(this.percentageValue(e.number))):n.New(this.percentageValue(e.number).mod(e.number))},n.prototype.percentageValue=function(e){return e.mul(this.number.div(n.base))},n.prototype.print=function(){return"% "+this.number.toString()},n.prototype.newNumeric=function(e){return n.New(e)},n.base=new e.Decimal(100),n}(n);t.Percentage=i;var o=function(e){function t(t,n){var r=e.call(this,t)||this;return r.unit=n,r.TYPE=a.UNIT,r.TYPERANK=c.UNIT,r}return u(t,e),t.New=function(e,n){return new t(e,n)},t.convertToUnit=function(e,n){if(e instanceof t){var r=e;if(r.unit.id===n.id&&r.unit.unitType!==n.unitType)return t.New(r.convert(n.ratio,n.bias),n)}return t.New(e.number,n)},t.prototype.newNumeric=function(e){return new t(e,this.unit)},t.prototype.isZero=function(){return this.number.isZero()},t.prototype.isNegative=function(){return this.number.isNegative()},t.prototype.isInteger=function(){return this.number.isInteger()},t.prototype.negated=function(){return this.newNumeric(this.number.negated())},t.prototype.plus=function(e){if(e instanceof t){var n=e;return this.unit.id===n.unit.id&&this.unit.unitType===n.unit.unitType?this.newNumeric(this.number.add(n.number)):this.unit.id!==n.unit.id?n.newNumeric(this.number.add(n.number)):n.newNumeric(this.convert(n.unit.ratio,n.unit.bias).add(n.number))}return this.newNumeric(this.number.plus(e.number))},t.prototype.mul=function(e){if(e instanceof t){var n=e;return this.unit.id===n.unit.id&&this.unit.unitType===n.unit.unitType?this.newNumeric(this.number.mul(n.number)):this.unit.id!==n.unit.id?n.newNumeric(this.number.mul(n.number)):n.newNumeric(this.convert(n.unit.ratio,n.unit.bias).mul(n.number))}return this.newNumeric(this.number.mul(e.number))},t.prototype.div=function(e){var n,r;if(this.leftflag?(n=this,r=e):(r=this,n=e),e instanceof t){var i=n,o=r;return i.unit.unitType===o.unit.unitType?i.newNumeric(i.number.div(o.number)):i.unit.id!==o.unit.id?i.newNumeric(i.number.div(r.number)):i.newNumeric(i.number.div(o.convert(i.unit.ratio,i.unit.bias)))}return this.newNumeric(n.number.div(r.number))},t.prototype.pow=function(e){var n,r;if(this.leftflag?(n=this,r=e):(r=this,n=e),e instanceof t){var i=n,o=r;return i.unit.unitType===o.unit.unitType?i.newNumeric(i.number.pow(o.number)):i.unit.id!==o.unit.id?i.newNumeric(i.number.pow(r.number)):i.newNumeric(i.number.pow(o.convert(i.unit.ratio,i.unit.bias)))}return this.newNumeric(n.number.pow(r.number))},t.prototype.mod=function(e){var n,r;if(this.leftflag?(n=this,r=e):(r=this,n=e),e instanceof t){var i=n,o=r;return i.unit.id!==o.unit.id?i.newNumeric(i.number.mod(o.number)):i.unit.unitType===o.unit.unitType?i.newNumeric(i.number.mod(o.number)):i.newNumeric(i.number.mod(o.convert(i.unit.ratio,i.unit.bias)))}return this.newNumeric(n.number.mod(r.number))},t.prototype.convert=function(e,t){return this.number.mul(this.unit.ratio).add(this.unit.bias).minus(t).div(e)},t.prototype.print=function(){return this.number.isZero()||this.number.equals(1)?this.number.toString()+" "+this.unit.singular:this.number.toString()+" "+this.unit.plural},t}(n);t.UnitNumber=o}(h=s.Type||(s.Type={})),s.Type=h;var p={};Object.defineProperty(p,"__esModule",{value:!0});var f=function(){function e(e,t,n){this.arbity=t,this.function=n,this.name=e}return e.prototype.call=function(e,t){var n=this.function(e,t);return null===n?s.Type.BNumber.New("0"):n},e}();p.FcalFunction=f;var l=function(){function e(){this.functions=Array()}return e.prototype.add=function(e){this.check(e.name)&&n.FcalError.throwWithoutCtx(e.name+" is already registered"),this.functions.push(e)},e.prototype.get=function(e){for(var t=0,n=this.functions;t<n.length;t++){var r=n[t];if(r.name===e)return[r,!0]}return[null,!1]},e.prototype.check=function(e){for(var t=0,n=this.functions;t<n.length;t++)if(n[t].name===e)return!0;return!1},e}();p.FcalFunctions=l;var d={};Object.defineProperty(d,"__esModule",{value:!0}),d.getDefaultFunction=function(){var e=new p.FcalFunctions;return e.add(new p.FcalFunction("abs",1,function(e,t){var n=t[0];return n.newNumeric(n.number.abs())})),e.add(new p.FcalFunction("sqrt",1,function(e,t){var n=t[0];return n.newNumeric(n.number.sqrt())})),e.add(new p.FcalFunction("cbrt",1,function(e,t){var n=t[0];return n.newNumeric(n.number.cbrt())})),e.add(new p.FcalFunction("log",1,function(e,t){var n=t[0];return n.newNumeric(n.number.log())})),e.add(new p.FcalFunction("ln",1,function(e,t){var n=t[0];return n.newNumeric(n.number.ln())})),e.add(new p.FcalFunction("round",1,function(e,t){var n=t[0];return n.newNumeric(n.number.round())})),e.add(new p.FcalFunction("floor",1,function(e,t){var n=t[0];return n.newNumeric(n.number.floor())})),e.add(new p.FcalFunction("ceil",1,function(e,t){var n=t[0];return n.newNumeric(n.number.ceil())})),e.add(new p.FcalFunction("cos",1,function(e,t){var n=t[0];return n.newNumeric(n.number.cosine())})),e.add(new p.FcalFunction("acos",1,function(e,t){var n=t[0];return n.newNumeric(n.number.inverseCosine())})),e.add(new p.FcalFunction("cosh",1,function(e,t){var n=t[0];return n.newNumeric(n.number.hyperbolicCosine())})),e.add(new p.FcalFunction("acosh",1,function(e,t){var n=t[0];return n.newNumeric(n.number.inverseHyperbolicCosine())})),e.add(new p.FcalFunction("sin",1,function(e,t){var n=t[0];return n.newNumeric(n.number.sine())})),e.add(new p.FcalFunction("asin",1,function(e,t){var n=t[0];return n.newNumeric(n.number.inverseSine())})),e.add(new p.FcalFunction("sinh",1,function(e,t){var n=t[0];return n.newNumeric(n.number.hyperbolicSine())})),e.add(new p.FcalFunction("asinh",1,function(e,t){var n=t[0];return n.newNumeric(n.number.inverseHyperbolicSine())})),e.add(new p.FcalFunction("tan",1,function(e,t){var n=t[0];return n.newNumeric(n.number.tangent())})),e.add(new p.FcalFunction("atan",1,function(e,t){var n=t[0];return n.newNumeric(n.number.inverseTangent())})),e.add(new p.FcalFunction("tanh",1,function(e,t){var n=t[0];return n.newNumeric(n.number.hyperbolicTangent())})),e.add(new p.FcalFunction("atanh",1,function(e,t){var n=t[0];return n.newNumeric(n.number.inverseHyperbolicTangent())})),e};var m={};Object.defineProperty(m,"__esModule",{value:!0});var v=function(){function t(t,n,r){this.id=t,this.ratio=n,this.bias=new e.Decimal(0),this.unitType=r,this.plural=r,this.singular=r}return t.prototype.setBias=function(e){this.bias=e},t.prototype.setPlural=function(e){this.plural=e},t.prototype.setSingular=function(e){this.singular=e},t}(),w=function(){function e(e,t,n,r){this.unit=new v(e,t,n),this.phrases=r}return e.prototype.setBias=function(e){return this.unit.setBias(e),this},e.prototype.Plural=function(e){return this.unit.setPlural(e),this},e.prototype.Singular=function(e){return this.unit.setSingular(e),this},e}();m.Unit=w,function(e){var t=function(){function e(){this.units=[]}return e.prototype.Add=function(e){this.check(e.phrases)&&n.FcalError.throwWithoutCtx("phrase already exists"),this.units.push(e)},e.prototype.check=function(e){for(var t=0,n=this.units;t<n.length;t++)for(var r=0,i=n[t].phrases;r<i.length;r++)for(var o=i[r],s=0,u=e;s<u.length;s++)if(o===u[s])return!0;return!1},e.prototype.get=function(e){for(var t=0,n=this.units;t<n.length;t++)for(var r=n[t],i=0,o=r.phrases;i<o.length;i++)if(e===o[i])return[r.unit,!0];return[null,!1]},e}();e.Units=t}(w=m.Unit||(m.Unit={})),m.Unit=w;var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.getdefaultUnits=function(){var t=new m.Unit.Units;return function(t){t.Add(new m.Unit("LENGTH",new e.Decimal(1),"cm",["cm","centimeter"]).Singular("Centimeter").Plural("Centimeters")),t.Add(new m.Unit("LENGTH",new e.Decimal(100),"m",["m","meter"]).Singular("Meter").Plural("Meters")),t.Add(new m.Unit("LENGTH",new e.Decimal(.1),"mm",["mm","milimeter"]).Singular("Milimeter").Plural("Milimeters")),t.Add(new m.Unit("LENGTH",new e.Decimal(1e5),"km",["km"]).Singular("Kilometer").Plural("Kilometers")),t.Add(new m.Unit("LENGTH",new e.Decimal(2.54),"inch",["inch"]).Singular("Inch").Plural("Inches")),t.Add(new m.Unit("LENGTH",new e.Decimal(30.48),"foot/feet",["ft"]).Singular("Foot").Plural("Feet")),t.Add(new m.Unit("LENGTH",new e.Decimal(91.44),"yard",["yd","yard"]).Singular("Yard").Plural("Yards")),t.Add(new m.Unit("LENGTH",new e.Decimal(160934.4),"mile",["mi"]).Singular("Mile").Plural("Miles")),t.Add(new m.Unit("LENGTH",new e.Decimal(185200),"nautical mile (nmi)",["nmi"]))}(t),function(t){t.Add(new m.Unit("SPEED",new e.Decimal(1),"km/h",["kmh","kmph","khm","kph"])),t.Add(new m.Unit("SPEED",new e.Decimal(1.609344),"miles/h",["mph"])),t.Add(new m.Unit("SPEED",new e.Decimal(3.6),"m/s",["mps"])),t.Add(new m.Unit("SPEED",new e.Decimal(1.097),"ft/s",["fps"])),t.Add(new m.Unit("SPEED",new e.Decimal(1.852),"kt",["kts","knots"]))}(t),function(t){t.Add(new m.Unit("TIME",new e.Decimal(1e9),"nsec",["nanosecond","nanoseconds"]).Singular("Nanosecond").Plural("Nanoseconds")),t.Add(new m.Unit("TIME",new e.Decimal(1e6),"msec",["microsecond","microseconds"]).Singular("Microsecond").Plural("Microseconds")),t.Add(new m.Unit("TIME",new e.Decimal(1),"second(s)",["sec","second","seconds"]).Singular("Second").Plural("Seconds")),t.Add(new m.Unit("TIME",new e.Decimal(60),"minute(s)",["min","minute","minutes"]).Singular("Minute").Plural("Minutes")),t.Add(new m.Unit("TIME",new e.Decimal(3600),"hour(s)",["hr","hour","hours"]).Singular("Hour").Plural("Hours")),t.Add(new m.Unit("TIME",new e.Decimal(86400),"day(s)",["day","days"]).Singular("Day").Plural("Days")),t.Add(new m.Unit("TIME",new e.Decimal(604800),"week(s)",["week","weeks"]).Singular("Week").Plural("Weeks"))}(t),function(t){t.Add(new m.Unit("TEMPERATURE",new e.Decimal(1),"K",["K","kelvin"])),t.Add(new m.Unit("TEMPERATURE",new e.Decimal("0.5555555555555555555555555"),"\xb0F",["\xb0F","F"]).setBias(new e.Decimal("255.3722222222222"))),t.Add(new m.Unit("TEMPERATURE",new e.Decimal(1),"\xb0C",["\xb0C","C"]).setBias(new e.Decimal(273.15)))}(t),t};var g={};Object.defineProperty(g,"__esModule",{value:!0});var y=function(){function e(){this.values={}}return e.prototype.get=function(e){if(this.values.hasOwnProperty(e))return this.values[e];throw n.FcalError.ErrorWithoutCtx("Undefined variable "+e)},e.prototype.set=function(e,t){t instanceof s.Type?this.values[e]=t:this.values[e]=s.Type.BNumber.New(t)},e}();g.Environment=y;var N,T={};function b(e){return N[e]}Object.defineProperty(T,"__esModule",{value:!0}),function(e){e[e.PLUS=0]="PLUS",e[e.MINUS=1]="MINUS",e[e.TIMES=2]="TIMES",e[e.MOD=3]="MOD",e[e.SLASH=4]="SLASH",e[e.Number=5]="Number",e[e.OPEN_PARAN=6]="OPEN_PARAN",e[e.CLOSE_PARAN=7]="CLOSE_PARAN",e[e.NEWLINE=8]="NEWLINE",e[e.EOL=9]="EOL",e[e.IN=10]="IN",e[e.NAME=11]="NAME",e[e.EQUAL=12]="EQUAL",e[e.COMMA=13]="COMMA",e[e.PERCENTAGE=14]="PERCENTAGE",e[e.OF=15]="OF",e[e.UNIT=16]="UNIT",e[e.CAP=17]="CAP"}(N=T.TokenType||(T.TokenType={}));var P=function(){function e(e,t,n,r,i){this.type=e,this.lexeme=t,this.start=r,this.end=i,this.Literal=n}return e.EOLToken=function(t){return new e(N.EOL,"",null,t,t)},e.prototype.toString=function(){var e="";return null!==this.Literal&&(e=this.Literal.format()),"< "+b(this.type)+" "+this.lexeme+" "+e+" ("+this.start+", "+this.end+")>"},e}();T.Token=P;var A={};Object.defineProperty(A,"__esModule",{value:!0});var x=function(){function e(){}return e.PLUS="+",e.MINUS="-",e.TIMES="*",e.MOD="mod",e.SLASH="/",e.OPEN_PARAN="(",e.CLOSE_PARAN=")",e.CAP="^",e.PERCENTAGE="%",e.EQUAL="=",e.DOUBLE_COLON=":",e.COMMA=",",e.NEWLINE="\n",e}();A.Char=x;var k={};Object.defineProperty(k,"__esModule",{value:!0});var U=function(){function e(e,t,n){this.source=e.replace(/[ \t]+$/,""),this.start=0,this.current=0,this.tokens=[],this.phrases=t,this.units=n}return e.isDigit=function(e){return e>="0"&&e<="9"},e.isAlpha=function(t){return!e.isDigit(t)&&!this.isSpace(t)&&"\0"!==t&&"\n"!==t&&!e.notAlpha.includes(t)},e.isSpace=function(e){return"\t"===e||" "===e},e.prototype.Next=function(){return this.isAtEnd()?T.Token.EOLToken(this.current):this.scan()},e.prototype.scan=function(){var t=this.space();switch(t){case A.Char.PLUS:return this.createToken(T.TokenType.PLUS);case A.Char.MINUS:return this.createToken(T.TokenType.MINUS);case A.Char.TIMES:return this.createToken(T.TokenType.TIMES);case A.Char.SLASH:return this.createToken(T.TokenType.SLASH);case A.Char.EQUAL:return this.createToken(T.TokenType.EQUAL);case A.Char.COMMA:return this.createToken(T.TokenType.COMMA);case A.Char.DOUBLE_COLON:return this.createToken(T.TokenType.EQUAL);case A.Char.OPEN_PARAN:return this.createToken(T.TokenType.OPEN_PARAN);case A.Char.CLOSE_PARAN:return this.createToken(T.TokenType.CLOSE_PARAN);case A.Char.CAP:return this.createToken(T.TokenType.CAP);case A.Char.PERCENTAGE:return this.createToken(T.TokenType.PERCENTAGE);case A.Char.NEWLINE:return this.createToken(T.TokenType.NEWLINE);default:return e.isDigit(t)?this.number():this.string()}},e.prototype.isAtEnd=function(){return this.current>=this.source.length},e.prototype.advance=function(){return this.current++,this.source.charAt(this.current-1)},e.prototype.peek=function(e){return this.current+e>=this.source.length?"\0":this.source.charAt(this.current+e)},e.prototype.string=function(){for(var t;e.isAlpha(this.peek(0))||e.isDigit(this.peek(0));)this.advance();var n,r=this.lexeme();return n=(t=this.phrases.search(r))[0],t[1]?this.createToken(n):this.units.get(r)[1]?this.createTokenWithLiteral(T.TokenType.UNIT,r):this.createToken(T.TokenType.NAME)},e.prototype.number=function(){for(;e.isDigit(this.peek(0));)this.advance();if("."===this.peek(0)&&e.isDigit(this.peek(1)))for(this.advance();e.isDigit(this.peek(0));)this.advance();if("E"===this.peek(0)||"e"===this.peek(0)){var t=this.peek(0);for(this.advance(),"+"!==this.peek(0)&&"-"!==this.peek(0)||(t=this.peek(0),this.advance()),e.isDigit(this.peek(0))||n.FcalError.throwWithEnd(this.start,this.current,"Expecting number after "+t+" but got '"+this.peek(0)+"'");e.isDigit(this.peek(0));)this.advance()}return this.createTokenWithLiteral(T.TokenType.Number,new s.Type.BNumber(this.lexeme()))},e.prototype.createToken=function(e){return this.createTokenWithLiteral(e,null)},e.prototype.createTokenWithLiteral=function(e,t){var n=new T.Token(e,this.lexeme(),t,this.start,this.current);return this.start=this.current,this.tokens.push(n),n},e.prototype.lexeme=function(){return this.source.substring(this.start,this.current)},e.prototype.space=function(){for(var t=this.advance();e.isSpace(t);)this.start=this.current,t=this.advance();return t},e.notAlpha=[A.Char.PLUS,A.Char.MINUS,A.Char.TIMES,A.Char.SLASH,A.Char.OPEN_PARAN,A.Char.CLOSE_PARAN,A.Char.CAP,A.Char.PERCENTAGE,A.Char.EQUAL,A.Char.COMMA,A.Char.DOUBLE_COLON],e}();k.Lexer=U;var S={};Object.defineProperty(S,"__esModule",{value:!0});var M=function(){function e(){this.depth=0}return e.createPrefix=function(e,t){return""+this.prefixchar+"-".repeat(e*this.tab)+" ("+e/this.tab+")"+t},e.prototype.visitCallExpr=function(t){return e.createPrefix(this.depth,"Function")+" \n|\n"+t.name},e.prototype.visitAssignExpr=function(t){this.depth+=e.tab;var n=this.evaluate(t.value);return this.depth-=e.tab,e.createPrefix(this.depth,"ASSIGN")+" \n|\n"+n},e.prototype.visitVariableExpr=function(t){return e.createPrefix(this.depth,"VARIABLE")+" "+t.name+"\n|\n"},e.prototype.visitUnitExpr=function(t){this.depth+=e.tab;var n=this.evaluate(t.expression);return this.depth-=e.tab,e.createPrefix(this.depth,"UNIT")+" "+t.unit.unitType+" \n|\n"+n},e.prototype.visitUnitConvertionExpr=function(t){this.depth+=e.tab;var n=this.evaluate(t.expression);return this.depth-=e.tab,e.createPrefix(this.depth,"UNIT CONVERT")+" "+t.unit.unitType+" \n|\n"+n},e.prototype.visitBinaryExpr=function(t){this.depth+=e.tab;var n=this.evaluate(t.left),r=this.evaluate(t.right);return this.depth-=e.tab,e.createPrefix(this.depth,"BINARY")+"  "+t.operator+" \n|\n"+n+r},e.prototype.visitGroupingExpr=function(t){this.depth+=e.tab;var n=this.evaluate(t.expression);return this.depth-=e.tab,e.createPrefix(this.depth,"Grouping")+" \n|\n"+n},e.prototype.visitLiteralExpr=function(t){return e.createPrefix(this.depth,"LITERAL")+" "+t.value.print()+"\n|\n"},e.prototype.visitUnaryExpr=function(t){this.depth+=e.tab;var n=this.evaluate(t.right);return this.depth-=e.tab,e.createPrefix(this.depth,"UNARY")+" "+t.operator+" \n|\n"+n},e.prototype.visitPercentageExpr=function(t){this.depth+=e.tab;var n=this.evaluate(t.expression);return this.depth-=e.tab,e.createPrefix(this.depth,"PERCENTAGE")+" \n|\n"+n},e.prototype.print=function(e){return this.evaluate(e)},e.prototype.evaluate=function(e){return e.accept(this)},e.tab=2,e.prefixchar="+",e}();S.ASTPrinter=M;var F,O={},C=this&&this.__extends||(F=function(e,t){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}F(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(O,"__esModule",{value:!0});var R=function(e){function t(t,n){var r=e.call(this)||this;return r.start=t,r.end=n,r}return C(t,e),t.prototype.toString=function(){return this.print(this)},t}(S.ASTPrinter);O.Expr=R,function(e){var t=function(e){function t(t,n,r,i,o){var s=e.call(this,i,o)||this;return s.left=t,s.operator=n,s.right=r,s}return C(t,e),t.prototype.accept=function(e){return e.visitBinaryExpr(this)},t}(e);e.Binary=t;var n=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.expression=t,i}return C(t,e),t.prototype.accept=function(e){return e.visitGroupingExpr(this)},t}(e);e.Grouping=n;var r=function(e){function t(t,n,r,i){var o=e.call(this,r,i)||this;return o.name=t,o.value=n,o}return C(t,e),t.prototype.accept=function(e){return e.visitAssignExpr(this)},t}(e);e.Assign=r;var i=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.name=t,i}return C(t,e),t.prototype.accept=function(e){return e.visitVariableExpr(this)},t}(e);e.Variable=i;var o=function(e){function t(t,n,r,i){var o=e.call(this,r,i)||this;return o.name=t,o.argument=n,o}return C(t,e),t.prototype.accept=function(e){return e.visitCallExpr(this)},t}(e);e.Call=o;var s=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.value=t,i}return C(t,e),t.prototype.accept=function(e){return e.visitLiteralExpr(this)},t}(e);e.Literal=s;var u=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.expression=t,i}return C(t,e),t.prototype.accept=function(e){return e.visitPercentageExpr(this)},t}(e);e.Percentage=u;var a=function(e){function t(t,n,r,i){var o=e.call(this,r,i)||this;return o.unit=n,o.expression=t,o}return C(t,e),t.prototype.accept=function(e){return e.visitUnitExpr(this)},t}(e);e.UnitExpr=a;var c=function(e){function t(t,n,r,i){var o=e.call(this,r,i)||this;return o.unit=n,o.expression=t,o}return C(t,e),t.prototype.accept=function(e){return e.visitUnitConvertionExpr(this)},t}(e);e.UnitConvertionExpr=c;var h=function(e){function t(t,n,r,i){var o=e.call(this,r,i)||this;return o.operator=t,o.right=n,o}return C(t,e),t.prototype.accept=function(e){return e.visitUnaryExpr(this)},t}(e);e.Unary=h}(R=O.Expr||(O.Expr={})),O.Expr=R;var L={};Object.defineProperty(L,"__esModule",{value:!0});var D=function(){function e(e,t,n){this.source=e,this.lexer=new k.Lexer(this.source,t,n),this.ntoken=0,this.tokens=[]}return e.prototype.parse=function(){return this.Stmt()},e.prototype.Stmt=function(){var e=this.assignment();if(this.match([T.TokenType.NEWLINE]))return e;throw this.peek().type===T.TokenType.EOL&&n.FcalError.throw(this.peek().end,"Expecting new Line"),n.FcalError.ErrorWithEnd(this.peek().start,this.peek().end,"Unexpected token "+this.peek().lexeme)},e.prototype.assignment=function(){var e=this.expression();if(this.match([T.TokenType.EQUAL])){var t=this.expression();if(e instanceof O.Expr.Variable){var n=e.name;return new O.Expr.Assign(n,t,e.start,t.end)}}return e},e.prototype.expression=function(){return this.percentage()},e.prototype.percentage=function(){for(var e=this.addition();this.match([T.TokenType.OF]);){var t=this.previous(),n=this.addition();e=new O.Expr.Binary(e,t,n,e.start,n.end)}return e},e.prototype.addition=function(){for(var e=this.multiply();this.match([T.TokenType.PLUS,T.TokenType.MINUS]);){var t=this.previous(),n=this.multiply();e=new O.Expr.Binary(e,t,n,e.start,n.end)}return e},e.prototype.multiply=function(){for(var e=this.unary();this.match([T.TokenType.TIMES,T.TokenType.SLASH,T.TokenType.MOD,T.TokenType.OF]);){var t=this.previous(),n=this.unary();e=new O.Expr.Binary(e,t,n,e.start,n.end)}return e},e.prototype.unary=function(){if(this.match([T.TokenType.PLUS,T.TokenType.MINUS])){var e=this.previous(),t=this.unary();return new O.Expr.Unary(e,t,e.start,t.end)}return this.exponent()},e.prototype.exponent=function(){for(var e=this.unitConvert();this.match([T.TokenType.CAP]);){var t=this.previous(),n=this.unary();e=new O.Expr.Binary(e,t,n,e.start,n.end)}return e},e.prototype.unitConvert=function(){var e=this.suffix();if(this.match([T.TokenType.IN])){this.consume(T.TokenType.UNIT,"Expecting unit after in");var t,n=this.previous();if(null!=(t=this.lexer.units.get(n.lexeme)[0]))return new O.Expr.UnitConvertionExpr(e,t,e.start,n.end)}return e},e.prototype.suffix=function(){var e=this.call();if(this.match([T.TokenType.PERCENTAGE])){var t=this.previous();return new O.Expr.Percentage(e,e.start,t.end)}if(this.match([T.TokenType.UNIT])){var n,r=this.previous();if(null!=(n=this.lexer.units.get(r.lexeme)[0]))return new O.Expr.UnitExpr(e,n,e.start,r.end)}return e},e.prototype.call=function(){var e=this.term();if(this.match([T.TokenType.OPEN_PARAN])){if(e instanceof O.Expr.Variable){var t=Array();if(this.peek().type!==T.TokenType.CLOSE_PARAN)do{t.length>=255&&n.FcalError.throwWithEnd(e.start,this.peek().end,e.name+" function cannot have more than 255 arguments"),t.push(this.expression())}while(this.match([T.TokenType.COMMA]));return this.consume(T.TokenType.CLOSE_PARAN,"Expect ')' after the arguments"),new O.Expr.Call(e.name,t,e.start,this.previous().end)}n.FcalError.throwWithEnd(e.start,this.previous().end,"Not callable")}return e},e.prototype.term=function(){if(this.match([T.TokenType.Number]))return new O.Expr.Literal(this.previous().Literal,this.previous().start,this.previous().end);if(this.match([T.TokenType.OPEN_PARAN])){var e=this.previous(),t=this.expression();return this.consume(T.TokenType.CLOSE_PARAN,"Expect ')' after expression"),new O.Expr.Grouping(t,e.start,this.previous().end)}if(this.match([T.TokenType.NAME]))return new O.Expr.Variable(this.previous().lexeme,this.previous().start,this.previous().end);throw n.FcalError.ErrorWithEnd(this.peek().start,this.peek().end,"Expect expression but found "+this.peek().lexeme)},e.prototype.match=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(this.check(r))return this.incr(),!0}return!1},e.prototype.consume=function(e,t){this.check(e)?this.incr():n.FcalError.throwWithEnd(this.peek().start,this.peek().end,t)},e.prototype.check=function(e){return!this.isAtEnd()&&this.peek().type===e},e.prototype.isAtEnd=function(){return this.nextToken().type===T.TokenType.EOL},e.prototype.nextToken=function(){return this.ntoken<this.tokens.length?this.tokens[this.ntoken]:this.getToken()},e.prototype.getToken=function(){var e=this.lexer.Next();return e.type!==T.TokenType.EOL&&this.tokens.push(e),e},e.prototype.previous=function(){return this.tokens[this.ntoken-1]},e.prototype.peek=function(){return this.nextToken()},e.prototype.incr=function(){this.ntoken++},e}();L.Parser=D;var _={};Object.defineProperty(_,"__esModule",{value:!0});var I=function(){function e(e,t,n,r,i){this.parser=new L.Parser(e,t,n),this.environment=r,this.funcations=i,this.ast=this.parser.parse()}return e.prototype.visitCallExpr=function(e){var t,r,i=e.name;if(r=(t=this.funcations.get(i))[0],t[1]&&null!=r){-1!==r.arbity&&r.arbity!==e.argument.length&&n.FcalError.throwWithEnd(e.start,e.end,"function "+i+" Expected "+r.arbity+" args but got "+e.argument.length);for(var o=Array(),s=0,u=e.argument;s<u.length;s++){var a=u[s];o.push(this.evaluate(a))}return r.call(this.environment,o)}throw n.FcalError.ErrorWithEnd(e.start,e.end,i+" is not callable")},e.prototype.visitAssignExpr=function(e){var t=this.evaluate(e.value);return this.environment.set(e.name,t),t},e.prototype.visitVariableExpr=function(e){return this.environment.get(e.name)},e.prototype.evaluateExpression=function(){return this.evaluate(this.ast)},e.prototype.visitUnitConvertionExpr=function(e){var t=this.evaluate(e.expression);if(t instanceof s.Type.Numberic)return s.Type.UnitNumber.convertToUnit(t,e.unit);throw n.FcalError.ErrorWithEnd(e.start,e.end,"Expecting numeric value before in")},e.prototype.visitUnitExpr=function(e){var t=this.evaluate(e.expression);if(t instanceof s.Type.Numberic)return s.Type.UnitNumber.New(t.number,e.unit);throw n.FcalError.ErrorWithEnd(e.start,e.end,"Expecting numeric value before unit")},e.prototype.visitBinaryExpr=function(e){var t=this.evaluate(e.left),n=this.evaluate(e.right);switch(e.operator.type){case T.TokenType.PLUS:return t.Add(n);case T.TokenType.MINUS:return t.Sub(n);case T.TokenType.TIMES:return t.times(n);case T.TokenType.SLASH:return t.divide(n);case T.TokenType.MOD:return n.isZero()?new s.Type.BNumber("Infinity"):t.modulo(n);case T.TokenType.CAP:return t.isNegative()&&!n.isInteger()?t.negated().power(n).negated():t.power(n);case T.TokenType.OF:var r=t=new s.Type.Percentage(t.number);return n.number=r.percentageValue(n.number),n;default:return s.Type.BNumber.ZERO}},e.prototype.visitGroupingExpr=function(e){return this.evaluate(e.expression)},e.prototype.visitLiteralExpr=function(e){return e.value},e.prototype.visitUnaryExpr=function(e){var t=this.evaluate(e.right);return e.operator.type===T.TokenType.MINUS?t.negated():t},e.prototype.visitPercentageExpr=function(e){var t=this.evaluate(e.expression);if(t instanceof s.Type.Numberic)return s.Type.Percentage.New(t.number);throw n.FcalError.ErrorWithEnd(e.start,e.end,"Expecting numeric value in percentage")},e.prototype.setValues=function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];this.environment.set(t,n)}},e.prototype.evaluate=function(e){return e.accept(this)},e}();_.Interpreter=I;var Y={};Object.defineProperty(Y,"__esModule",{value:!0});var B=function(){function e(e,t){this.type=e,this.phrases=t}return e.prototype.add=function(e){for(var t,r=0,i=e;r<i.length;r++){var o=i[r];this.check([o])&&n.FcalError.throwWithoutCtx(o+" already exists")}(t=this.phrases).push.apply(t,e)},e.prototype.check=function(e){for(var t=0,n=this.phrases;t<n.length;t++)for(var r=n[t],i=0,o=e;i<o.length;i++)if(o[i]===r)return!0;return!1},e}(),W=function(){function e(){this.phrases=[]}return e.prototype.add=function(e){this.phrases.push(e)},e.prototype.getPhrases=function(e){for(var t=0,n=this.phrases;t<n.length;t++){var r=n[t];if(r.type===e)return[r.phrases,!0]}return[[],!1]},e.prototype.search=function(e){e=e.toUpperCase();for(var t=0,n=this.phrases;t<n.length;t++){var r=n[t];if(r.phrases.find(function(t){return t===e}))return[r.type,!0]}return[0,!1]},e.prototype.addPhrases=function(e,t){var r;t=t.map(function(e){return e.toUpperCase()}),this.checkPhrase(t)&&n.FcalError.throwWithoutCtx("phrases already exits");for(var i=0,o=this.phrases;i<o.length;i++){var s=o[i];s.type===e&&(r=s.phrases).push.apply(r,t)}this.add(new B(e,t))},e.prototype.checkPhrase=function(e){for(var t=0,n=this.phrases;t<n.length;t++)if(n[t].check(e))return!0;return!1},e}();Y.Phrases=W;var G={};Object.defineProperty(G,"__esModule",{value:!0}),G.Decimal=e.Decimal,G.Environment=g.Environment,G.FcalFunction=p.FcalFunction,G.FcalFunctions=p.FcalFunctions,G.Type=s.Type,G.Unit=m.Unit;var H=function(){function e(){this.phrases=e.getdefaultphrases(),this.units=E.getdefaultUnits(),this.environment=new g.Environment,this.setDefaultValues(),this.functions=new p.FcalFunctions,this.setDefaultFunctions()}return e.getdefaultphrases=function(){var e=new Y.Phrases;return e.addPhrases(T.TokenType.PLUS,["PLUS","AND","WITH","ADD"]),e.addPhrases(T.TokenType.MINUS,["MINUS","SUBTRACT","WITHOUT"]),e.addPhrases(T.TokenType.TIMES,["TIMES","x","MULTIPLIEDBY","mul"]),e.addPhrases(T.TokenType.SLASH,["DIVIDE","DIVIDEBY"]),e.addPhrases(T.TokenType.CAP,["POW"]),e.addPhrases(T.TokenType.MOD,["mod"]),e.addPhrases(T.TokenType.OF,["of"]),e.addPhrases(T.TokenType.IN,["in","as"]),e},e.prototype.evaluate=function(e){return e=K(e),new _.Interpreter(e,this.phrases,this.units,this.environment,this.functions).evaluateExpression()},e.prototype.expression=function(e){var t=new g.Environment;return t.values=Object.assign({},this.environment.values),e=K(e),new V(new _.Interpreter(e,this.phrases,this.units,t,this.functions))},e.prototype.expressionSync=function(e){return e=K(e),new V(new _.Interpreter(e,this.phrases,this.units,this.environment,this.functions))},e.prototype.setValues=function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];this.environment.set(t,n)}},e.prototype.setFunctions=function(e){for(var t=0,n=e.functions;t<n.length;t++){var r=n[t];this.functions.add(r)}},e.prototype.setDefaultValues=function(){this.setValues({E:s.Type.BNumber.New("2.718281828459045235360287"),PI:s.Type.BNumber.New("3.141592653589793238462645"),PI2:s.Type.BNumber.New("6.28318530718")})},e.prototype.setDefaultFunctions=function(){this.setFunctions(d.getDefaultFunction())},e}();function K(e){return e.endsWith("\n")?e:e+"\n"}G.Fcal=H;var V=function(){function e(e){this.interpreter=e}return e.prototype.evaluate=function(){return this.interpreter.evaluateExpression()},e.prototype.setValues=function(e){this.interpreter.setValues(e)},e}();return G.Expression=V,G});